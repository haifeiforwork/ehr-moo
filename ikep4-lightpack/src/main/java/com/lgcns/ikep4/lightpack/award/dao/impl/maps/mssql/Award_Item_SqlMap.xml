<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="lightpack.award.dao.awardItem">
  <typeAlias alias="AwardItem"                type="com.lgcns.ikep4.lightpack.award.model.AwardItem"/>
  <typeAlias alias="AwardItemSearchCondition" type="com.lgcns.ikep4.lightpack.award.search.AwardItemSearchCondition"/>
   
  <resultMap id="awardItemMinResult" class="com.lgcns.ikep4.lightpack.award.model.AwardItem" >
    <result column="ITEM_ID"           property="itemId"               jdbcType="VARCHAR" />
    <result column="BOARD_ID"          property="awardId"              jdbcType="VARCHAR" />
    <result column="TITLE"             property="title"                jdbcType="VARCHAR" /> 
    <result column="START_DATE"        property="startDate"            jdbcType="TIMESTAMP" />
    <result column="END_DATE"          property="endDate"              jdbcType="TIMESTAMP" />
    <result column="ITEM_DELETE"       property="itemDelete"           jdbcType="DECIMAL" /> 
  </resultMap>  
  <resultMap id="awardItemResult" class="com.lgcns.ikep4.lightpack.award.model.AwardItem" >
    <result column="ITEM_ID"           property="itemId"               jdbcType="VARCHAR" />
    <result column="BOARD_ID"          property="awardId"              jdbcType="VARCHAR" />
    <result column="ITEM_PARENT_ID"    property="itemParentId"         jdbcType="VARCHAR" />
    <result column="ITEM_GROUP_ID"     property="itemGroupId"          jdbcType="VARCHAR" />
    <result column="STEP"              property="step"                 jdbcType="DECIMAL" />
    <result column="INDENTATION"       property="indentation"          jdbcType="DECIMAL" />
    <result column="ITEM_SEQ_ID"       property="itemSeqId"            jdbcType="VARCHAR" /> 
    <result column="ITEM_DISPLAY"      property="itemDisplay"          jdbcType="DECIMAL"  nullValue="0" />
    <result column="TITLE"             property="title"                jdbcType="VARCHAR" />
    <result column="HIT_COUNT"         property="hitCount"             jdbcType="DECIMAL" />
    <result column="RECOMMEND_COUNT"   property="recommendCount"       jdbcType="DECIMAL" />
    <result column="REPLY_COUNT"       property="replyCount"           jdbcType="DECIMAL" />
    <result column="LINEREPLY_COUNT"   property="linereplyCount"       jdbcType="DECIMAL" />
    <result column="ATTACH_FILE_COUNT" property="attachFileCount"      jdbcType="DECIMAL" />
    <result column="START_DATE"        property="startDate"            jdbcType="TIMESTAMP" />
    <result column="END_DATE"          property="endDate"              jdbcType="TIMESTAMP" />
    <result column="ITEM_DELETE"       property="itemDelete"           jdbcType="DECIMAL" />
    <result column="TEMP_SAVE"        property="tempSave"            jdbcType="VARCHAR" />
    <result column="IMAGE_FILE_ID"     property="imageFileId"          jdbcType="VARCHAR" />
    <result column="CONTENTS"          property="contents"             jdbcType="CLOB" />
    <result column="REGISTER_ID"       property="registerId"           jdbcType="VARCHAR" />
    <result column="REGISTER_NAME"     property="registerName"         jdbcType="VARCHAR" />
    <result column="REGIST_DATE"       property="registDate"           jdbcType="TIMESTAMP" />
    <result column="UPDATER_ID"        property="updaterId"            jdbcType="VARCHAR" />
    <result column="UPDATER_NAME"      property="updaterName"          jdbcType="VARCHAR" />
    <result column="UPDATE_DATE"       property="updateDate"           jdbcType="TIMESTAMP" /> 
    <result column="ITEM_FOREVER"      property="itemForever"          jdbcType="DECIMAL"  nullValue="0" /> 
    <result column="READER_MAIL_FLAG"      property="readerMailFlag"          jdbcType="DECIMAL" nullValue="0"  /> 
    <result column="DIS_START_DATE"        property="disStartDate"            jdbcType="TIMESTAMP" />
    <result column="DIS_END_DATE"          property="disEndDate"              jdbcType="TIMESTAMP" />
    <result column="DISPLAY_NAME"          property="displayName"              jdbcType="VARCHAR" />
  </resultMap> 
  <resultMap id="awardItemResultNonContents" class="com.lgcns.ikep4.lightpack.award.model.AwardItem" >
    <result column="ITEM_ID"           property="itemId"               jdbcType="VARCHAR" />
    <result column="BOARD_ID"          property="awardId"              jdbcType="VARCHAR" />
    <result column="ITEM_PARENT_ID"    property="itemParentId"         jdbcType="VARCHAR" />
    <result column="ITEM_GROUP_ID"     property="itemGroupId"          jdbcType="VARCHAR" />
    <result column="STEP"              property="step"                 jdbcType="DECIMAL" />
    <result column="INDENTATION"       property="indentation"          jdbcType="DECIMAL" />
    <result column="ITEM_SEQ_ID"       property="itemSeqId"            jdbcType="VARCHAR" /> 
    <result column="ITEM_DISPLAY"      property="itemDisplay"          jdbcType="DECIMAL"  nullValue="0" />
    <result column="TITLE"             property="title"                jdbcType="VARCHAR" />
    <result column="HIT_COUNT"         property="hitCount"             jdbcType="DECIMAL" />
    <result column="RECOMMEND_COUNT"   property="recommendCount"       jdbcType="DECIMAL" />
    <result column="REPLY_COUNT"       property="replyCount"           jdbcType="DECIMAL" />
    <result column="LINEREPLY_COUNT"   property="linereplyCount"       jdbcType="DECIMAL" />
    <result column="ATTACH_FILE_COUNT" property="attachFileCount"      jdbcType="DECIMAL" />
    <result column="START_DATE"        property="startDate"            jdbcType="TIMESTAMP" />
    <result column="END_DATE"          property="endDate"              jdbcType="TIMESTAMP" />
    <result column="ITEM_DELETE"       property="itemDelete"           jdbcType="DECIMAL" />
    <result column="TEMP_SAVE"        property="tempSave"            jdbcType="VARCHAR" />
    <result column="IMAGE_FILE_ID"     property="imageFileId"          jdbcType="VARCHAR" />
    <result column="REGISTER_ID"       property="registerId"           jdbcType="VARCHAR" />
    <result column="REGISTER_NAME"     property="registerName"         jdbcType="VARCHAR" />
    <result column="REGIST_DATE"       property="registDate"           jdbcType="TIMESTAMP" />
    <result column="UPDATER_ID"        property="updaterId"            jdbcType="VARCHAR" />
    <result column="UPDATER_NAME"      property="updaterName"          jdbcType="VARCHAR" />
    <result column="UPDATE_DATE"       property="updateDate"           jdbcType="TIMESTAMP" /> 
    <result column="ITEM_FOREVER"      property="itemForever"          jdbcType="DECIMAL"  nullValue="0" /> 
    <result column="READER_MAIL_FLAG"      property="readerMailFlag"          jdbcType="DECIMAL" nullValue="0"  /> 
    <result column="DISPLAY_NAME"          property="displayName"              jdbcType="VARCHAR" />
  </resultMap> 
  <resultMap id="awardItemResultExtend" extends="awardItemResult"  class="com.lgcns.ikep4.lightpack.award.model.AwardItem" > 
    <result column="JOB_RANK_NAME"          property="user.jobRankName"         jdbcType="VARCHAR" />
    <result column="TEAM_NAME"              property="user.teamName"            jdbcType="VARCHAR" />
    <result column="JOB_DUTY_NAME"          property="user.jobDutyName"         jdbcType="VARCHAR" />
    <result column="JOB_POSITION_NAME"      property="user.jobPositionName"     jdbcType="VARCHAR" />
    <result column="JOB_TITLE_NAME"         property="user.jobTitleName"        jdbcType="VARCHAR" />  
    <result column="PICTURE_ID"             property="user.pictureId"           jdbcType="VARCHAR" />   
    <result column="PROFILE_PICTURE_ID"     property="user.profilePictureId"    jdbcType="VARCHAR" />  
	<result column="USER_NAME"              property="user.userName"            jdbcType="VARCHAR" />
	<result column="USER_ENGLISH_NAME"      property="user.userEnglishName"     jdbcType="VARCHAR" />
	<result column="JOB_TITLE_ENGLISH_NAME" property="user.jobTitleEnglishName" jdbcType="VARCHAR" />
	<result column="TEAM_ENGLISH_NAME"      property="user.teamEnglishName"     jdbcType="VARCHAR" /> 
	<result column="WORD_ID"                property="wordId"                   jdbcType="VARCHAR" />
	<result column="WORD_NAME"              property="wordName"                 jdbcType="VARCHAR" /> 
	<result column="AWARD_KIND"		property="awardKind"		                 jdbcType="VARCHAR" />			
	<result column="COMPANY_CODE"		property="companyCode"		                 jdbcType="VARCHAR" />			
	<result column="AWARD_TITLE"		property="awardTitle"		                 jdbcType="VARCHAR" />			
	<result column="AWARD_TXT"		property="awardTxt"		                 jdbcType="VARCHAR" />			
	<result column="PUBLISHER"		property="publisher"		                 jdbcType="VARCHAR" />			
	<result column="AWARD_DATE"		property="awardDate"		                 jdbcType="TIMESTAMP" />			
	<result column="AWARD_GRADE"		property="awardGrade"		                 jdbcType="VARCHAR" />			
	<result column="AWARD_MATERIAL"		property="awardMaterial"	                 jdbcType="VARCHAR" />			
	<result column="STORAGE_LOC_CD"		property="storageLocCd"		                 jdbcType="VARCHAR" />			
	<result column="STORAGE_LOC_DETAIL"		property="storageLocDetail"		                 jdbcType="VARCHAR" />			
	<result column="RES_DEPT_ID"		property="resDeptId"		                 jdbcType="VARCHAR" />			
	<result column="AWARD_PROMOTION_DETAIL"		property="awardPromotionDetail"		                 jdbcType="VARCHAR" />			
	<result column="WRITE_EMP_NO"		property="writeEmpNo"		                 jdbcType="VARCHAR" />	
	<result column="AWARD_KIND_TXT"		property="awardKindTxt"		                 jdbcType="VARCHAR" />
	<result column="COMPANY_CODE_TXT"		property="companyCodeTxt"		                 jdbcType="VARCHAR" />
	<result column="STORAGE_LOC_TXT"		property="storageLocTxt"		                 jdbcType="VARCHAR" />
	<result column="AWARD_MATERIALS"		property="awardMaterials"	                 jdbcType="VARCHAR" />	
  </resultMap> 
  <resultMap id="awardItemResultExtendNonContents" extends="awardItemResultNonContents"  class="com.lgcns.ikep4.lightpack.award.model.AwardItem" > 
    <result column="JOB_RANK_NAME"          property="user.jobRankName"         jdbcType="VARCHAR" />
    <result column="TEAM_NAME"              property="user.teamName"            jdbcType="VARCHAR" />
    <result column="JOB_DUTY_NAME"          property="user.jobDutyName"         jdbcType="VARCHAR" />
    <result column="JOB_POSITION_NAME"      property="user.jobPositionName"     jdbcType="VARCHAR" />
    <result column="JOB_TITLE_NAME"         property="user.jobTitleName"        jdbcType="VARCHAR" />  
    <result column="PICTURE_ID"             property="user.pictureId"           jdbcType="VARCHAR" />   
    <result column="PROFILE_PICTURE_ID"     property="user.profilePictureId"    jdbcType="VARCHAR" />  
	<result column="USER_NAME"              property="user.userName"            jdbcType="VARCHAR" />
	<result column="USER_ENGLISH_NAME"      property="user.userEnglishName"     jdbcType="VARCHAR" />
	<result column="JOB_TITLE_ENGLISH_NAME" property="user.jobTitleEnglishName" jdbcType="VARCHAR" />
	<result column="TEAM_ENGLISH_NAME"      property="user.teamEnglishName"     jdbcType="VARCHAR" /> 
	<result column="WORD_ID"                property="wordId"                   jdbcType="VARCHAR" />
	<result column="WORD_NAME"              property="wordName"                 jdbcType="VARCHAR" /> 
	<result column="AWARD_KIND"		property="awardKind"		                 jdbcType="VARCHAR" />			
	<result column="COMPANY_CODE"		property="companyCode"		                 jdbcType="VARCHAR" />			
	<result column="AWARD_TITLE"		property="awardTitle"		                 jdbcType="VARCHAR" />			
	<result column="AWARD_TXT"		property="awardTxt"		                 jdbcType="VARCHAR" />			
	<result column="PUBLISHER"		property="publisher"		                 jdbcType="VARCHAR" />			
	<result column="AWARD_DATE"		property="awardDate"		                 jdbcType="TIMESTAMP" />			
	<result column="AWARD_GRADE"		property="awardGrade"		                 jdbcType="VARCHAR" />			
	<result column="AWARD_MATERIAL"		property="awardMaterial"	                 jdbcType="VARCHAR" />			
	<result column="STORAGE_LOC_CD"		property="storageLocCd"		                 jdbcType="VARCHAR" />			
	<result column="STORAGE_LOC_DETAIL"		property="storageLocDetail"		                 jdbcType="VARCHAR" />			
	<result column="RES_DEPT_ID"		property="resDeptId"		                 jdbcType="VARCHAR" />			
	<result column="AWARD_PROMOTION_DETAIL"		property="awardPromotionDetail"		                 jdbcType="VARCHAR" />			
	<result column="WRITE_EMP_NO"		property="writeEmpNo"		                 jdbcType="VARCHAR" />
	<result column="AWARD_KIND_TXT"		property="awardKindTxt"		                 jdbcType="VARCHAR" />
	<result column="COMPANY_CODE_TXT"		property="companyCodeTxt"		                 jdbcType="VARCHAR" />
	<result column="STORAGE_LOC_TXT"		property="storageLocTxt"		                 jdbcType="VARCHAR" />
  </resultMap>
  
  <resultMap id="awardItemResultExtendNonContentsRead" extends="awardItemResultExtendNonContents"  class="com.lgcns.ikep4.lightpack.award.model.AwardItem" > 
    <result column="READ_YN"          property="readYn"         jdbcType="VARCHAR" />
    <result column="READ_FLG"          property="readFlg"         jdbcType="VARCHAR" />
  </resultMap>
  
  <resultMap id="awardItemResultExtendNonContentsMaterial" extends="awardItemResultExtendNonContents"  class="com.lgcns.ikep4.lightpack.award.model.AwardItem" > 
    <result column="READ_YN"          property="readYn"         jdbcType="VARCHAR" />
    <result column="READ_FLG"          property="readFlg"         jdbcType="VARCHAR" />
    <result column="awardMaterial"          property="awardMaterial"         jdbcType="VARCHAR" />
  </resultMap>
  
  <resultMap id="awardMenuResult" class="com.lgcns.ikep4.lightpack.award.model.AwardItem" > 
    <result column="BOARD_ID"          		property="awardId"         jdbcType="VARCHAR" />
    <result column="BOARD_NAME"         property="awardName"              jdbcType="VARCHAR" />
  </resultMap>
  
  <resultMap id="presentAwardMenuResult" class="com.lgcns.ikep4.lightpack.award.model.AwardItem" > 
    <result column="ITEM_ID"          		property="awardId"         jdbcType="VARCHAR" />
  </resultMap>
  <resultMap id="resultCode" class="com.lgcns.ikep4.lightpack.award.model.AwardItem" > 
    <result column="COM_CD"        property="comCd"       jdbcType="VARCHAR" />
    <result column="COM_NM"      property="comNm"      jdbcType="VARCHAR" />
  </resultMap> 
  <select id="listCode" resultMap="resultCode" parameterClass="String">   
	SELECT 
			COM_CD,
			COM_NM
	 FROM  TB_COMMON_CODE
	 WHERE GRP_CD = #code#
	 ORDER BY SORT_ORD
  </select>
  
  <sql id="sqlMinColumnList"> 
    ITEM_ID, 
    BOARD_ID, 
    TITLE,
    START_DATE, 
    END_DATE, 
    ITEM_DELETE,
    IMAGE_FILE_ID
  </sql>  
  <sql id="sqlColumnList"> 
    ITEM_ID, 
    BOARD_ID, 
    ITEM_PARENT_ID, 
    ITEM_GROUP_ID, 
    STEP, 
    INDENTATION, 
    ITEM_SEQ_ID,  
    ITEM_DISPLAY, 
    TITLE,
    HIT_COUNT, 
    RECOMMEND_COUNT, 
    REPLY_COUNT, 
    LINEREPLY_COUNT, 
    ATTACH_FILE_COUNT, 
    START_DATE, 
    END_DATE, 
    ITEM_DELETE,
    IMAGE_FILE_ID, 
    CONTENTS,
    REGISTER_ID, 
    REGISTER_NAME, 
    REGIST_DATE, 
    UPDATER_ID, 
    UPDATER_NAME, 
    UPDATE_DATE,
    TEMP_SAVE,
    WORD_ID,
    WORD_NAME,
    ITEM_FOREVER ,
    READER_MAIL_FLAG,
    DIS_START_DATE,
    DIS_END_DATE,
    DISPLAY_NAME,
    AWARD_KIND,
	COMPANY_CODE,
	AWARD_TITLE,
	AWARD_TXT,
	PUBLISHER,
	AWARD_DATE,
	AWARD_GRADE,
	AWARD_MATERIAL,
	STORAGE_LOC_CD,
	STORAGE_LOC_DETAIL,
	RES_DEPT_ID,
	AWARD_PROMOTION_DETAIL,
	WRITE_EMP_NO,
	AWARD_MATERIALS
  </sql>  
  <sql id="sqlExtendColumnList"> 
    item.ITEM_ID           AS ITEM_ID,           
    item.BOARD_ID          AS BOARD_ID,          
    item.ITEM_PARENT_ID    AS ITEM_PARENT_ID,    
    item.ITEM_GROUP_ID     AS ITEM_GROUP_ID,     
    item.STEP              AS STEP,              
    item.INDENTATION       AS INDENTATION,       
    item.ITEM_SEQ_ID       AS ITEM_SEQ_ID,       
    item.ITEM_DISPLAY      AS ITEM_DISPLAY,      
    item.TITLE             AS TITLE,             
    item.HIT_COUNT         AS HIT_COUNT,         
    item.RECOMMEND_COUNT   AS RECOMMEND_COUNT,   
    item.REPLY_COUNT       AS REPLY_COUNT,       
    item.LINEREPLY_COUNT   AS LINEREPLY_COUNT,   
    item.ATTACH_FILE_COUNT AS ATTACH_FILE_COUNT, 
    item.START_DATE        AS START_DATE,        
    item.END_DATE          AS END_DATE,          
    item.ITEM_DELETE       AS ITEM_DELETE,
    item.IMAGE_FILE_ID     AS IMAGE_FILE_ID,          
    replace(item.CONTENTS,'HY태고딕','맑은 고딕')          AS CONTENTS,          
    item.REGISTER_ID       AS REGISTER_ID,       
    item.REGISTER_NAME     AS REGISTER_NAME,     
    item.REGIST_DATE       AS REGIST_DATE,       
    item.UPDATER_ID        AS UPDATER_ID,        
    item.UPDATER_NAME      AS UPDATER_NAME,      
    item.UPDATE_DATE       AS UPDATE_DATE,  
    item.TEMP_SAVE         AS TEMP_SAVE ,
    item.READER_MAIL_FLAG AS READER_MAIL_FLAG,
    item.WORD_ID           AS WORD_ID,  
    item.WORD_NAME         AS WORD_NAME, 
    item.ITEM_FOREVER      AS ITEM_FOREVER,  
    item.DIS_START_DATE        AS DIS_START_DATE,        
    item.DIS_END_DATE          AS DIS_END_DATE,
    item.DISPLAY_NAME      AS DISPLAY_NAME,
    usr.TEAM_NAME          AS TEAM_NAME,  
    usr.PICTURE_ID         AS PICTURE_ID, 
    usr.PROFILE_PICTURE_ID AS PROFILE_PICTURE_ID,     
	(SELECT JOB_RANK_NAME FROM IKEP4_EV_JOB_RANK WHERE IKEP4_EV_JOB_RANK.JOB_RANK_CODE = usr.JOB_RANK_CODE) AS JOB_RANK_NAME,
	(SELECT JOB_DUTY_NAME FROM IKEP4_EV_JOB_DUTY WHERE IKEP4_EV_JOB_DUTY.JOB_DUTY_CODE = usr.JOB_DUTY_CODE) AS JOB_DUTY_NAME,
	(SELECT JOB_POSITION_NAME FROM IKEP4_EV_JOB_POSITION WHERE IKEP4_EV_JOB_POSITION.JOB_POSITION_CODE = usr.JOB_POSITION_CODE) AS JOB_POSITION_NAME,
	(SELECT JOB_TITLE_NAME FROM IKEP4_EV_JOB_TITLE WHERE IKEP4_EV_JOB_TITLE.JOB_TITLE_CODE = usr.JOB_TITLE_CODE) AS JOB_TITLE_NAME, 
    usr.USER_NAME  AS USER_NAME,
    usr.USER_ENGLISH_NAME  AS USER_ENGLISH_NAME,
    usr.TEAM_ENGLISH_NAME  AS TEAM_ENGLISH_NAME,  
    (SELECT JOB_TITLE_ENGLISH_NAME FROM IKEP4_EV_JOB_TITLE WHERE IKEP4_EV_JOB_TITLE.JOB_TITLE_CODE = usr.JOB_TITLE_CODE) AS JOB_TITLE_ENGLISH_NAME,
    item.AWARD_KIND   AS   AWARD_KIND,
	item.COMPANY_CODE   AS  COMPANY_CODE,
	item.AWARD_TITLE   AS  AWARD_TITLE,
	item.AWARD_TXT   AS  AWARD_TXT,
	item.PUBLISHER   AS  PUBLISHER,
	CONVERT(VARCHAR,item.AWARD_DATE,102)   AS  AWARD_DATE,
	item.AWARD_GRADE   AS  AWARD_GRADE,
	item.AWARD_MATERIAL   AS  AWARD_MATERIAL,
	item.STORAGE_LOC_CD   AS  STORAGE_LOC_CD,
	item.STORAGE_LOC_DETAIL   AS  STORAGE_LOC_DETAIL,
	item.RES_DEPT_ID   AS  RES_DEPT_ID,
	item.AWARD_PROMOTION_DETAIL   AS  AWARD_PROMOTION_DETAIL,
	item.WRITE_EMP_NO  AS  WRITE_EMP_NO,
	(select com_nm from TB_COMMON_CODE where grp_cd = 'C00009' and com_cd = item.AWARD_KIND) AS AWARD_KIND_TXT,  
	(select com_nm from TB_COMMON_CODE where grp_cd = 'C00015' and com_cd = item.COMPANY_CODE) AS COMPANY_CODE_TXT,   
	(select com_nm from TB_COMMON_CODE where grp_cd = 'C00012' and com_cd = item.STORAGE_LOC_CD) AS STORAGE_LOC_TXT,
	item.AWARD_MATERIALS   AS  AWARD_MATERIALS
  </sql>  
  <sql id="sqlExtendColumnListNonContents"> 
    item.ITEM_ID           AS ITEM_ID,           
    item.BOARD_ID          AS BOARD_ID,          
    item.ITEM_PARENT_ID    AS ITEM_PARENT_ID,    
    item.ITEM_GROUP_ID     AS ITEM_GROUP_ID,     
    item.STEP              AS STEP,              
    item.INDENTATION       AS INDENTATION,       
    item.ITEM_SEQ_ID       AS ITEM_SEQ_ID,       
    item.ITEM_DISPLAY      AS ITEM_DISPLAY,      
    item.TITLE             AS TITLE,             
    item.HIT_COUNT         AS HIT_COUNT,         
    item.RECOMMEND_COUNT   AS RECOMMEND_COUNT,   
    item.REPLY_COUNT       AS REPLY_COUNT,       
    item.LINEREPLY_COUNT   AS LINEREPLY_COUNT,   
    item.ATTACH_FILE_COUNT AS ATTACH_FILE_COUNT, 
    item.START_DATE        AS START_DATE,        
    item.END_DATE          AS END_DATE,          
    item.ITEM_DELETE       AS ITEM_DELETE,
    item.IMAGE_FILE_ID     AS IMAGE_FILE_ID,           
    item.REGISTER_ID       AS REGISTER_ID,       
    item.REGISTER_NAME     AS REGISTER_NAME,     
    item.REGIST_DATE       AS REGIST_DATE,       
    item.UPDATER_ID        AS UPDATER_ID,        
    item.UPDATER_NAME      AS UPDATER_NAME,      
    item.UPDATE_DATE       AS UPDATE_DATE,  
    item.TEMP_SAVE         AS TEMP_SAVE ,
    item.READER_MAIL_FLAG AS READER_MAIL_FLAG,
    item.WORD_ID           AS WORD_ID,  
    item.WORD_NAME         AS WORD_NAME, 
    item.ITEM_FOREVER      AS ITEM_FOREVER,  
    item.DISPLAY_NAME      AS DISPLAY_NAME,
    usr.TEAM_NAME          AS TEAM_NAME,  
    usr.PICTURE_ID         AS PICTURE_ID, 
    usr.PROFILE_PICTURE_ID AS PROFILE_PICTURE_ID,     
	(SELECT JOB_RANK_NAME FROM IKEP4_EV_JOB_RANK WHERE IKEP4_EV_JOB_RANK.JOB_RANK_CODE = usr.JOB_RANK_CODE) AS JOB_RANK_NAME,
	(SELECT JOB_DUTY_NAME FROM IKEP4_EV_JOB_DUTY WHERE IKEP4_EV_JOB_DUTY.JOB_DUTY_CODE = usr.JOB_DUTY_CODE) AS JOB_DUTY_NAME,
	(SELECT JOB_POSITION_NAME FROM IKEP4_EV_JOB_POSITION WHERE IKEP4_EV_JOB_POSITION.JOB_POSITION_CODE = usr.JOB_POSITION_CODE) AS JOB_POSITION_NAME,
	(SELECT JOB_TITLE_NAME FROM IKEP4_EV_JOB_TITLE WHERE IKEP4_EV_JOB_TITLE.JOB_TITLE_CODE = usr.JOB_TITLE_CODE) AS JOB_TITLE_NAME, 
    usr.USER_NAME  AS USER_NAME,
    usr.USER_ENGLISH_NAME  AS USER_ENGLISH_NAME,
    usr.TEAM_ENGLISH_NAME  AS TEAM_ENGLISH_NAME,  
    (SELECT JOB_TITLE_ENGLISH_NAME FROM IKEP4_EV_JOB_TITLE WHERE IKEP4_EV_JOB_TITLE.JOB_TITLE_CODE = usr.JOB_TITLE_CODE) AS JOB_TITLE_ENGLISH_NAME,
    item.AWARD_KIND   AS   AWARD_KIND,
	item.COMPANY_CODE   AS  COMPANY_CODE,
	item.AWARD_TITLE   AS  AWARD_TITLE,
	item.AWARD_TXT   AS  AWARD_TXT,
	item.PUBLISHER   AS  PUBLISHER,
	CONVERT(VARCHAR,item.AWARD_DATE,102)   AS  AWARD_DATE,
	item.AWARD_GRADE   AS  AWARD_GRADE,
	item.AWARD_MATERIAL   AS  AWARD_MATERIAL,
	item.STORAGE_LOC_CD   AS  STORAGE_LOC_CD,
	item.STORAGE_LOC_DETAIL   AS  STORAGE_LOC_DETAIL,
	item.RES_DEPT_ID   AS  RES_DEPT_ID,
	item.AWARD_PROMOTION_DETAIL   AS  AWARD_PROMOTION_DETAIL,
	item.WRITE_EMP_NO  AS  WRITE_EMP_NO,
	(select com_nm from TB_COMMON_CODE where grp_cd = 'C00009' and com_cd = item.AWARD_KIND) AS AWARD_KIND_TXT,  
	(select com_nm from TB_COMMON_CODE where grp_cd = 'C00015' and com_cd = item.COMPANY_CODE) AS COMPANY_CODE_TXT,   
	(select com_nm from TB_COMMON_CODE where grp_cd = 'C00012' and com_cd = item.STORAGE_LOC_CD) AS STORAGE_LOC_TXT,
	item.AWARD_MATERIALS   AS  AWARD_MATERIALS      
  </sql>
   
    <!-- MS SQL -->
  <select id="listRecentAllAwardItem" parameterClass="map" resultMap="awardItemResultExtendNonContents">
    SELECT  /* [AwardItem_SqlMap.xml] awardItem.listRecentAllAwardItem */ TOP $count$ *
    FROM (
     SELECT
     	   <include refid="lightpack.award.dao.awardItem.sqlExtendColumnListNonContents" /> 
	 FROM  IKEP4_AW_ITEM item INNER JOIN IKEP4_EV_USER usr
	 ON    item.REGISTER_ID = usr.USER_ID  
     <![CDATA[   
     WHERE item.ITEM_DELETE = 0
     AND item.BOARD_ID NOT IN ('100000793108','100000793116')
     AND CURRENT_TIMESTAMP BETWEEN item.START_DATE AND item.END_DATE
     AND item.TEMP_SAVE = '0'  
    ) TBL
   	ORDER BY START_DATE DESC, REGIST_DATE DESC
    ]]> 
  </select> 

  <!-- MS SQL -->
  <select id="listRecentAwardItem" parameterClass="AwardItemSearchCondition" resultMap="awardItemResultExtendNonContents">
    SELECT  /* [AwardItem_SqlMap.xml] awardItem.listRecentAwardItem */ TOP $recordCount$ *
    FROM (
     SELECT
     	/*+ USE_NL(item usr) INDEX(usr IDX_EV_USER_PK)  */	
     	   <include refid="lightpack.award.dao.awardItem.sqlExtendColumnListNonContents" /> 
	 FROM  IKEP4_AW_ITEM item INNER JOIN IKEP4_EV_USER usr
	 ON    item.REGISTER_ID = usr.USER_ID  
   
     WHERE  item.BOARD_ID = #awardId#
     AND    item.ITEM_DELETE = 0
     AND     CURRENT_TIMESTAMP BETWEEN item.START_DATE AND item.END_DATE
     AND    item.temp_save = '0'
       
    ) TBL
    ORDER BY START_DATE DESC, REGIST_DATE DESC    
  </select>    
  <select id="listRecentAwardItem2" parameterClass="AwardItemSearchCondition" resultMap="awardItemResultExtendNonContents">
    SELECT  /* [AwardItem_SqlMap.xml] awardItem.listRecentAwardItem2 */ TOP $recordCount$ *
    FROM (
     SELECT
     	/*+ USE_NL(item usr) INDEX(usr IDX_EV_USER_PK)  */	
     	   <include refid="lightpack.award.dao.awardItem.sqlExtendColumnListNonContents" /> 
	 FROM  IKEP4_AW_ITEM item INNER JOIN IKEP4_EV_USER usr
	 ON    item.REGISTER_ID = usr.USER_ID  
   
     WHERE  item.BOARD_ID = #awardId#
     AND    item.ITEM_DELETE = 0
	<isEqual property="admin" compareValue="false">
	<isNotEmpty property="awardAdminUse">
		<isEqual property="awardAdminUse" compareValue="true">
			<isNotEmpty property="awardAdmin">
				<isEqual property="awardAdmin" compareValue="false">
					AND ( #userId# in 
				 (
						   select AU.person_id from IKEP4_AW_ITEM_READER  rdr 
						   INNER JOIN IKEP4_AD_ADDRGROUP AG ON rdr.reader_id=AG.addrgroup_id 
						   INNER JOIN IKEP4_AD_PERSON2GROUP AU ON AG.addrgroup_id =AU.addrgroup_id 
						   where item.item_id=rdr.board_item_id and rdr.reader_type='C'
				 
				 )
				 
		or #userId# = 	
			( CASE WHEN
				(select count(r.reader_id) from IKEP4_AW_ITEM_READER r 
				where  r.reader_type in ('C','U','G') and r.board_item_id=item.item_id) =0
			then
				#userId#	
			else 
				''
			end
			)	 
		or #userId# in ( select AU.user_id from IKEP4_AW_ITEM_READER rdr INNER JOIN IKEP4_EV_GROUP AG ON rdr.reader_id=AG.group_id 
									INNER JOIN IKEP4_EV_USER_GROUP AU ON AG.group_id =AU.group_id where item.item_id=rdr.board_item_id 
									and rdr.reader_type='G' )
		or #userId# = 	
			( CASE WHEN
				(select count(r.reader_id) from IKEP4_AW_ITEM_READER r 
				where  r.reader_type='U' and r.board_item_id=item.item_id and r.reader_id = #userId#) =1
			then
				#userId#	
			else 
				''
			end
			)	
		or 	#userId# =	 item.REGISTER_ID
	)		 
				</isEqual>
			</isNotEmpty>
		</isEqual>
	</isNotEmpty>
	<isEmpty property="awardAdminUse">
	    AND ( #userId# in 
				 (
						   select AU.person_id from IKEP4_AW_ITEM_READER  rdr 
						   INNER JOIN IKEP4_AD_ADDRGROUP AG ON rdr.reader_id=AG.addrgroup_id 
						   INNER JOIN IKEP4_AD_PERSON2GROUP AU ON AG.addrgroup_id =AU.addrgroup_id 
						   where item.item_id=rdr.board_item_id and rdr.reader_type='C'
				 
				 )
				 
		or #userId# = 	
			( CASE WHEN
				(select count(r.reader_id) from IKEP4_AW_ITEM_READER r 
				where  r.reader_type in ('C','U','G') and r.board_item_id=item.item_id) =0
			then
				#userId#	
			else 
				''
			end
			)	 
			or #userId# in ( select AU.user_id from IKEP4_AW_ITEM_READER rdr INNER JOIN IKEP4_EV_GROUP AG ON rdr.reader_id=AG.group_id 
						INNER JOIN IKEP4_EV_USER_GROUP AU ON AG.group_id =AU.group_id where item.item_id=rdr.board_item_id 
						and rdr.reader_type='G' )
		or #userId# = 	
			( CASE WHEN
				(select count(r.reader_id) from IKEP4_AW_ITEM_READER r 
				where  r.reader_type='U' and r.board_item_id=item.item_id and r.reader_id = #userId#) =1
			then
				#userId#	
			else 
				''
			end
			)	
		or 	#userId# =	 item.REGISTER_ID
	)		 
	</isEmpty>
	</isEqual>
     AND     CURRENT_TIMESTAMP BETWEEN item.START_DATE AND item.END_DATE
     AND    item.temp_save = '0'
       
    ) TBL
    ORDER BY ITEM_DISPLAY DESC, START_DATE DESC, REGIST_DATE DESC    
  </select> 
  <!-- MS SQL -->
  <select id="listBatchDeletePassedAwardItem" parameterClass="int" resultMap="awardItemMinResult">
    SELECT /* [AwardItem_SqlMap.xml] awardItem.batchRemoveItemList */
    	   TOP $getCount$ <include refid="lightpack.award.dao.awardItem.sqlMinColumnList" /> 
    FROM   IKEP4_AW_ITEM 
    <![CDATA[  
    WHERE  ITEM_ID = ITEM_GROUP_ID
    AND    END_DATE < DATEADD(DD, 1, CURRENT_TIMESTAMP)
    ]]> 
  </select>  
 
   <!-- ANSI -->
  <select id="listBatchDeleteStatusAwardItem" parameterClass="int" resultMap="awardItemMinResult">
    SELECT /* [AwardItem_SqlMap.xml] awardItem.batchRemoveItemList */
    	   <include refid="lightpack.award.dao.awardItem.sqlMinColumnList" /> 
    FROM   IKEP4_AW_ITEM 
    <![CDATA[  
    WHERE  ITEM_DELETE = 2 
    ]]> 
  </select>

  <!-- ANSI -->
  <select id="get" parameterClass="string" resultMap="awardItemResultExtend"> 
    SELECT /* [AwardItem_SqlMap.xml] awardItem.get */
          <include refid="lightpack.award.dao.awardItem.sqlExtendColumnList" /> 
	FROM  IKEP4_AW_ITEM item INNER JOIN IKEP4_EV_USER usr
	ON    item.REGISTER_ID = usr.USER_ID
    WHERE item.ITEM_ID = #itemId# 
  </select> 
  
   <select id="materialList" parameterClass="String" resultClass="String"> 
    SELECT 
          material 
	FROM  ikep4_aw_material 
    WHERE ITEM_ID = #itemId# 
  </select>

  <!-- ANSI -->
  <select id="listByItemIdArray" parameterClass="list" resultMap="awardItemResultExtend"> 
    SELECT /* [AwardItem_SqlMap.xml] awardItem.get */
          <include refid="lightpack.award.dao.awardItem.sqlExtendColumnList" /> 
	FROM  IKEP4_AW_ITEM item INNER JOIN IKEP4_EV_USER usr
	ON    item.REGISTER_ID = usr.USER_ID    
    WHERE item.ITEM_ID IN (<iterate conjunction=","> #awardItemIdArray[]# </iterate>) 
  </select>

  <!-- ANSI -->
  <select id="exists" parameterClass="string" resultClass="int"> 
    SELECT /* [AwardItem_SqlMap.xml] awardItem.exists */
    	  COUNT(*)
    FROM  IKEP4_AW_ITEM item INNER JOIN IKEP4_EV_USER usr
    ON    item.REGISTER_ID = usr.USER_ID   
    WHERE item.ITEM_ID = #itemId# 
  </select>   

  <!-- ANSI -->
  <select id="listReplayItemThreadByItemId" parameterClass="String" resultMap="awardItemResultExtendNonContents">    
	SELECT   /* [AwardItem_SqlMap.xml] awardItem.listThreadByItemId */  
	 <include refid="lightpack.award.dao.awardItem.sqlExtendColumnListNonContents" /> 
	FROM ( 
		SELECT * 
		FROM IKEP4_AW_ITEM
		WHERE ITEM_GROUP_ID = #itemId#
		AND   ITEM_DELETE &lt; 2
		)  item  INNER JOIN IKEP4_EV_USER usr
	ON    item.REGISTER_ID = usr.USER_ID		
    ORDER BY ITEM_GROUP_ID DESC, STEP ASC
  </select> 

  <!-- MS SQL -->
  <select id="listLowerItemThread" parameterClass="String" resultMap="awardItemResult">   
  	WITH CTE AS (
  		SELECT	*
		FROM	IKEP4_AW_ITEM
 		WHERE	ITEM_ID = #itemId#
 		UNION ALL
 		SELECT	T.*
 		FROM	IKEP4_AW_ITEM T, CTE
 		WHERE	CTE.ITEM_ID = T.ITEM_PARENT_ID 
  	)
	SELECT /* [AwardItem_SqlMap.xml] awardItem.listLowerItemThread */ 
	       <include refid="lightpack.award.dao.awardItem.sqlColumnList" /> 
	FROM CTE
  </select>  

  <!-- MS SQL -->
  <select id="listByAwardItemOfDeletedAward" parameterClass="map" resultMap="awardItemResult">   
	SELECT /* [AwardItem_SqlMap.xml] awardItem.listByAwardItemOfDeletedAward */ 
	       TOP $getCount$ <include refid="lightpack.award.dao.awardItem.sqlColumnList" /> 
	FROM  IKEP4_AW_ITEM
	WHERE BOARD_ID = #awardId#
	AND   INDENTATION = 0  
  </select>
 
  <!-- MS SQL -->
  <select id="listBySearchCondition" parameterClass="AwardItemSearchCondition" resultMap="awardItemResultExtendNonContentsRead">  
  SELECT /* [AwardItem_SqlMap.xml] awardItem.listBySearchCondition */ 
        *
  FROM (
		     SELECT A.* FROM ( 
		         /* START========================================= */
		         SELECT Row_number() OVER (ORDER BY
												<isNotEmpty property="sortColumn">
													<isEqual property="sortColumn" compareValue="ITEM_SEQ_ID">
														<isEqual property="sortType" compareValue="DESC">
															item.ITEM_SEQ_ID DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.ITEM_SEQ_ID ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="AWARD_KIND">
														<isEqual property="sortType" compareValue="DESC">
															item.AWARD_KIND DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.AWARD_KIND ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="ATTACH_FILE_COUNT">
														<isEqual property="sortType" compareValue="DESC">
															item.ATTACH_FILE_COUNT DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.ATTACH_FILE_COUNT ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="COMPANY_CODE">
														<isEqual property="sortType" compareValue="DESC">
															item.COMPANY_CODE DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.COMPANY_CODE ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="REGISTER_NAME">
														<isEqual property="sortType" compareValue="DESC">
															item.REGISTER_NAME DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.REGISTER_NAME ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="AWARD_DATE">
														<isEqual property="sortType" compareValue="DESC">
															item.AWARD_DATE DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.AWARD_DATE ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="HIT_COUNT">
														<isEqual property="sortType" compareValue="DESC">
															item.HIT_COUNT DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.HIT_COUNT ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="RECOMMEND_COUNT">
														<isEqual property="sortType" compareValue="DESC">
															item.RECOMMEND_COUNT DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.RECOMMEND_COUNT ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="AWARD_TITLE">
														<isEqual property="sortType" compareValue="DESC">
															item.AWARD_TITLE DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.AWARD_TITLE ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="AWARD_TXT">
														<isEqual property="sortType" compareValue="DESC">
															item.AWARD_TXT DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.AWARD_TXT ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="PUBLISHER">
														<isEqual property="sortType" compareValue="DESC">
															item.PUBLISHER DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.PUBLISHER ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="AWARD_MATERIAL">
														<isEqual property="sortType" compareValue="DESC">
															item.AWARD_MATERIAL DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.AWARD_MATERIAL ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="STORAGE_LOC_CD">
														<isEqual property="sortType" compareValue="DESC">
															item.STORAGE_LOC_CD DESC,item.AWARD_PROMOTION_DETAIL DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.STORAGE_LOC_CD ASC,item.AWARD_PROMOTION_DETAIL ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="AWARD_GRADE">
														<isEqual property="sortType" compareValue="DESC">
															item.AWARD_GRADE DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.AWARD_GRADE ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="RES_DEPT_ID">
														<isEqual property="sortType" compareValue="DESC">
															item.RES_DEPT_ID DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.RES_DEPT_ID ASC,
														</isEqual>
													</isEqual> 
												</isNotEmpty>  
											    item.ITEM_DISPLAY DESC, item.ITEM_GROUP_ID DESC, item.STEP ASC	) AS RNUM,
		         		<include refid="lightpack.award.dao.awardItem.sqlExtendColumnListNonContents" /> 
		         		,(select count(*) from IKEP4_AW_REFERENCE R WHERE R.item_id = item.item_id AND R.register_id = #userId#) AS READ_YN
		         		<![CDATA[
		         		, case when item.regist_date > '20140911' then '1' else '0' end AS READ_FLG
		        ]]>
		         FROM   IKEP4_AW_ITEM item INNER JOIN IKEP4_EV_USER usr
	             ON     item.REGISTER_ID = usr.USER_ID 
				 WHERE  
	 				 item.BOARD_ID = #awardId# 
     			 AND    item.ITEM_DELETE &lt; 2
     			 AND 	item.temp_save = '0'

     			 AND (CURRENT_TIMESTAMP BETWEEN item.START_DATE AND item.END_DATE)
				<isNotEmpty property="searchColumn">
					<isNotEmpty property="searchWord">
						<isEqual property="searchColumn" compareValue="title">
							AND	replace(item.TITLE,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%'
						</isEqual>
						<isEqual property="searchColumn" compareValue="registerName">
							AND (replace(usr.USER_NAME,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%' OR replace(usr.USER_ENGLISH_NAME,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%')
						</isEqual>
						<isEqual property="searchColumn" compareValue="all">
							AND (replace(usr.USER_NAME,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%' OR replace(usr.USER_ENGLISH_NAME,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%' OR replace(item.TITLE,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%') 
						</isEqual>
						<isEqual property="searchColumn" compareValue="publisher">
							AND	replace(item.PUBLISHER,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%'
						</isEqual>
						<isEqual property="searchColumn" compareValue="awardTitle">
							AND	replace(item.AWARD_TITLE,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%'
						</isEqual>
						<isEqual property="searchColumn" compareValue="awardTxt">
							AND	replace(item.AWARD_TXT,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%'
						</isEqual>
					</isNotEmpty>
				</isNotEmpty>  
				<isNotEmpty property="searchStorageLocCd">
					and item.STORAGE_LOC_CD = #searchStorageLocCd#
				</isNotEmpty>
				<isNotEmpty property="searchCompanyCode">
					and item.COMPANY_CODE = #searchCompanyCode#
				</isNotEmpty>
				<isNotEmpty property="searchAwardKind">
					and item.AWARD_KIND = #searchAwardKind#
				</isNotEmpty>
				<isNotEmpty property="searchAwardGrade">
					and item.AWARD_GRADE = #searchAwardGrade#
				</isNotEmpty>
				<isNotEmpty property="searchAwardMaterial">
					and item.AWARD_MATERIAL LIKE '%'+ #searchAwardMaterial#+ '%'
				</isNotEmpty>
				<isNotEmpty property="wordId">
					and item.word_id = #wordId#
				</isNotEmpty>
				<isEqual property="admin" compareValue="false">
				<isNotEmpty property="awardAdminUse">
					<isEqual property="awardAdminUse" compareValue="true">
						<isNotEmpty property="awardAdmin">
							<isEqual property="awardAdmin" compareValue="false">
								<![CDATA[   
					AND (CURRENT_TIMESTAMP BETWEEN item.START_DATE AND item.END_DATE   OR   item.REGISTER_ID = #userId# )   
					]]>
							</isEqual>
						</isNotEmpty>
					</isEqual>
				</isNotEmpty>
				<isEmpty property="awardAdminUse">
				     <![CDATA[   
					AND (CURRENT_TIMESTAMP BETWEEN item.START_DATE AND item.END_DATE   OR   item.REGISTER_ID = #userId# )   
					]]>
				</isEmpty>
				</isEqual>		
				 /* ===========================================END  */  
		<![CDATA[   
		    ) A WHERE RNUM <=  #endRowIndex# /* 종료  */
		) TBL WHERE RNUM >  #startRowIndex# /* 시작 */ 
	]]> 
  </select>   
  
  <select id="listBySearchCondition3" parameterClass="AwardItemSearchCondition" resultMap="awardItemResultExtendNonContentsMaterial">  
  SELECT /* [AwardItem_SqlMap.xml] awardItem.listBySearchCondition3 */ 
        *
  FROM (
		     SELECT A.* FROM ( 
		         /* START========================================= */
		         SELECT Row_number() OVER (ORDER BY
												<isNotEmpty property="sortColumn">
													<isEqual property="sortColumn" compareValue="ITEM_SEQ_ID">
														<isEqual property="sortType" compareValue="DESC">
															item.ITEM_SEQ_ID DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.ITEM_SEQ_ID ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="ATTACH_FILE_COUNT">
														<isEqual property="sortType" compareValue="DESC">
															item.ATTACH_FILE_COUNT DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.ATTACH_FILE_COUNT ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="TITLE">
														<isEqual property="sortType" compareValue="DESC">
															item.TITLE DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.TITLE ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="REGISTER_NAME">
														<isEqual property="sortType" compareValue="DESC">
															item.REGISTER_NAME DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.REGISTER_NAME ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="START_DATE">
														<isEqual property="sortType" compareValue="DESC">
															item.START_DATE DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.START_DATE ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="HIT_COUNT">
														<isEqual property="sortType" compareValue="DESC">
															item.HIT_COUNT DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.HIT_COUNT ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="RECOMMEND_COUNT">
														<isEqual property="sortType" compareValue="DESC">
															item.RECOMMEND_COUNT DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.RECOMMEND_COUNT ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="WORD_NAME">
														<isEqual property="sortType" compareValue="DESC">
															item.WORD_NAME DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.WORD_NAME ASC,
														</isEqual>
													</isEqual> 
												</isNotEmpty>  
											    item.ITEM_DISPLAY DESC, item.ITEM_GROUP_ID DESC, item.STEP ASC	) AS RNUM,
		         		<include refid="lightpack.award.dao.awardItem.sqlExtendColumnListNonContents" /> 
		         		,(select count(*) from IKEP4_AW_REFERENCE R WHERE R.item_id = item.item_id AND R.register_id = #userId#) AS READ_YN
		         		<![CDATA[
		         		, case when item.regist_date > '20140911' then '1' else '0' end AS READ_FLG,
		        ]]>
		        (SELECT      
				STUFF((SELECT ',' + CONVERT(VarChar(50) , material) 
				            FROM ikep4_aw_material AS B 
				WHERE A.item_id = B.item_id  FOR XML PATH ('')),1,1,'')
				                 FROM ikep4_aw_material AS A
								 where A.item_id = item.item_id
				                 GROUP BY item_id) as awardMaterial
		         FROM   IKEP4_AW_ITEM item 
		         INNER JOIN IKEP4_EV_USER usr ON     item.REGISTER_ID = usr.USER_ID 

				 WHERE  
	 				 item.BOARD_ID = #awardId# 
     			 AND    item.ITEM_DELETE &lt; 2
     			 AND 	item.temp_save = '0'
			 	<isNotEmpty property="searchMaterial">
			 	AND  item_id in ( 
			 		select item_id from ikep4_aw_material
					where material in(<iterate property="searchMaterials" conjunction=","> #searchMaterials[]# </iterate>)
				)
			 	</isNotEmpty>
     			 AND (CURRENT_TIMESTAMP BETWEEN item.START_DATE AND item.END_DATE)
				<isNotEmpty property="searchColumn">
					<isNotEmpty property="searchWord">
						<isEqual property="searchColumn" compareValue="title">
							AND	replace(item.TITLE,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%'
						</isEqual>
						<isEqual property="searchColumn" compareValue="registerName">
							AND (replace(usr.USER_NAME,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%' OR replace(usr.USER_ENGLISH_NAME,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%')
						</isEqual>
						<isEqual property="searchColumn" compareValue="all">
							AND (replace(usr.USER_NAME,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%' OR replace(usr.USER_ENGLISH_NAME,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%' OR replace(item.TITLE,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%') 
						</isEqual>
						<isEqual property="searchColumn" compareValue="publisher">
							AND	replace(item.PUBLISHER,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%'
						</isEqual>
						<isEqual property="searchColumn" compareValue="awardTitle">
							AND	replace(item.AWARD_TITLE,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%'
						</isEqual>
						<isEqual property="searchColumn" compareValue="awardTxt">
							AND	replace(item.AWARD_TXT,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%'
						</isEqual>
					</isNotEmpty>
				</isNotEmpty>  
				<isNotEmpty property="searchStorageLocCd">
					and item.STORAGE_LOC_CD = #searchStorageLocCd#
				</isNotEmpty>
				<isNotEmpty property="searchCompanyCode">
					and item.COMPANY_CODE = #searchCompanyCode#
				</isNotEmpty>
				<isNotEmpty property="searchAwardKind">
					and item.AWARD_KIND = #searchAwardKind#
				</isNotEmpty>
				<isNotEmpty property="searchAwardGrade">
					and item.AWARD_GRADE = #searchAwardGrade#
				</isNotEmpty>
				<isNotEmpty property="searchAwardMaterial">
					and item.AWARD_MATERIAL LIKE +'%'+ #searchAwardMaterial#+ '%'
				</isNotEmpty>
				<isNotEmpty property="wordId">
					and item.word_id = #wordId#
				</isNotEmpty>
				<isNotEmpty property="endPeriod">
				<![CDATA[
				AND item.award_date <=  #endPeriod#
				]]>	
				</isNotEmpty>
				<isNotEmpty property="startPeriod">
				<![CDATA[
				AND item.award_date >=  #startPeriod#
				]]>	
				</isNotEmpty>
				<isEqual property="admin" compareValue="false">
					<isNotEmpty property="awardAdminUse">
						<isEqual property="awardAdminUse" compareValue="true">
							<isNotEmpty property="awardAdmin">
								<isEqual property="awardAdmin" compareValue="false">
									<![CDATA[   
									AND (CURRENT_TIMESTAMP BETWEEN item.START_DATE AND item.END_DATE   OR   item.REGISTER_ID = #userId# )   
									]]>
								</isEqual>
							</isNotEmpty>
						</isEqual>
					</isNotEmpty>
					<isEmpty property="awardAdminUse">
					     <![CDATA[   
							AND (CURRENT_TIMESTAMP BETWEEN item.START_DATE AND item.END_DATE   OR   item.REGISTER_ID = #userId# )   
							]]>
					</isEmpty>
				</isEqual>	
				 /* ===========================================END  */  
		<![CDATA[   
		    ) A WHERE RNUM <=  #endRowIndex# /* 종료  */
		) TBL WHERE RNUM >  #startRowIndex# /* 시작 */ 
	]]> 
  </select>   
  
  <select id="deleteListBySearchCondition" parameterClass="AwardItemSearchCondition" resultMap="awardItemResultExtendNonContents">  
  SELECT /* [AwardItem_SqlMap.xml] awardItem.deleteListBySearchCondition */ 
        *
  FROM (
		     SELECT A.* FROM ( 
		         /* START========================================= */
		         SELECT Row_number() OVER (ORDER BY
												<isNotEmpty property="sortColumn">
													<isEqual property="sortColumn" compareValue="ITEM_SEQ_ID">
														<isEqual property="sortType" compareValue="DESC">
															item.ITEM_SEQ_ID DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.ITEM_SEQ_ID ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="ATTACH_FILE_COUNT">
														<isEqual property="sortType" compareValue="DESC">
															item.ATTACH_FILE_COUNT DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.ATTACH_FILE_COUNT ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="TITLE">
														<isEqual property="sortType" compareValue="DESC">
															item.TITLE DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.TITLE ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="REGISTER_NAME">
														<isEqual property="sortType" compareValue="DESC">
															item.REGISTER_NAME DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.REGISTER_NAME ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="START_DATE">
														<isEqual property="sortType" compareValue="DESC">
															item.START_DATE DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.START_DATE ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="HIT_COUNT">
														<isEqual property="sortType" compareValue="DESC">
															item.HIT_COUNT DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.HIT_COUNT ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="RECOMMEND_COUNT">
														<isEqual property="sortType" compareValue="DESC">
															item.RECOMMEND_COUNT DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.RECOMMEND_COUNT ASC,
														</isEqual>
													</isEqual> 
												</isNotEmpty>  
											    item.ITEM_DISPLAY DESC, item.ITEM_GROUP_ID DESC, item.STEP ASC	) AS RNUM,
		         		<include refid="lightpack.award.dao.awardItem.sqlExtendColumnListNonContents" /> 
		         FROM   IKEP4_AW_ITEM item INNER JOIN IKEP4_EV_USER usr
	             ON     item.REGISTER_ID = usr.USER_ID 
				 <![CDATA[   
				 	WHERE (item.ITEM_DELETE = 1 OR CURRENT_TIMESTAMP > item.END_DATE)
				 	and item.award_id in (select bd.award_id from IKEP4_AW_AWARD bd where bd.award_delete = 0)
				 	]]> 
				<isNotEmpty property="searchColumn">
					<isNotEmpty property="searchWord">
						<isEqual property="searchColumn" compareValue="title">
							AND	replace(item.TITLE,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%'
						</isEqual>
						<isEqual property="searchColumn" compareValue="registerName">
							AND (replace(usr.USER_NAME,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%' OR replace(usr.USER_ENGLISH_NAME,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%')
						</isEqual>
						<isEqual property="searchColumn" compareValue="all">
							AND (replace(usr.USER_NAME,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%' OR replace(usr.USER_ENGLISH_NAME,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%' OR replace(item.TITLE,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%') 
						</isEqual>
					</isNotEmpty>
				</isNotEmpty>  
				 /* ===========================================END  */  
		<![CDATA[   
		    ) A WHERE RNUM <=  #endRowIndex# /* 종료  */
		) TBL WHERE RNUM >  #startRowIndex# /* 시작 */ 
	]]> 
  </select>   
  
  <select id="listBySearchCondition2" parameterClass="AwardItemSearchCondition" resultMap="awardItemResultExtendNonContentsRead">  
  SELECT /* [AwardItem_SqlMap.xml] awardItem.listBySearchCondition2 */ 
        *
  FROM (
		     SELECT A.* FROM ( 
		         /* START========================================= */
		         SELECT Row_number() OVER (ORDER BY
												<isNotEmpty property="sortColumn">
													<isEqual property="sortColumn" compareValue="ITEM_SEQ_ID">
														<isEqual property="sortType" compareValue="DESC">
															item.ITEM_SEQ_ID DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.ITEM_SEQ_ID ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="ATTACH_FILE_COUNT">
														<isEqual property="sortType" compareValue="DESC">
															item.ATTACH_FILE_COUNT DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.ATTACH_FILE_COUNT ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="TITLE">
														<isEqual property="sortType" compareValue="DESC">
															item.TITLE DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.TITLE ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="REGISTER_NAME">
														<isEqual property="sortType" compareValue="DESC">
															item.REGISTER_NAME DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.REGISTER_NAME ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="START_DATE">
														<isEqual property="sortType" compareValue="DESC">
															item.START_DATE DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.START_DATE ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="HIT_COUNT">
														<isEqual property="sortType" compareValue="DESC">
															item.HIT_COUNT DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.HIT_COUNT ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="RECOMMEND_COUNT">
														<isEqual property="sortType" compareValue="DESC">
															item.RECOMMEND_COUNT DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.RECOMMEND_COUNT ASC,
														</isEqual>
													</isEqual> 
												</isNotEmpty>  
											    item.ITEM_DISPLAY DESC, item.ITEM_GROUP_ID DESC, item.STEP ASC	) AS RNUM,
		         		<include refid="lightpack.award.dao.awardItem.sqlExtendColumnListNonContents" /> 
		         		,(select count(*) from IKEP4_AW_REFERENCE R WHERE R.item_id = item.item_id AND R.register_id = #userId#) AS READ_YN
		         		<![CDATA[
		         		, case when item.regist_date > '20140911' then '1' else '0' end AS READ_FLG
		        ]]>
		         FROM   IKEP4_AW_ITEM item 
		         INNER JOIN IKEP4_EV_USER usr ON     item.REGISTER_ID = usr.USER_ID 

				 WHERE  
	 				 item.BOARD_ID = #awardId# 
     			 AND    item.ITEM_DELETE &lt; 2
     			 AND 	item.temp_save = '0'
     			 <isEqual property="admin" compareValue="false">
     			 	<isNotEmpty property="awardAdminUse">
     			 		<isEqual property="awardAdminUse" compareValue="true">
     			 			<isNotEmpty property="awardAdmin">
		     			 		<isEqual property="awardAdmin" compareValue="false">
		     			 			AND ( #userId# in 
								 	(
										   select AU.person_id from IKEP4_AW_ITEM_READER  rdr 
										   INNER JOIN IKEP4_AD_ADDRGROUP AG ON rdr.reader_id=AG.addrgroup_id 
										   INNER JOIN IKEP4_AD_PERSON2GROUP AU ON AG.addrgroup_id =AU.addrgroup_id 
										   where item.item_id=rdr.award_item_id and rdr.reader_type='C'
								 
								 	)
								 
									or #userId# = 	
										( CASE WHEN
											(select count(r.reader_id) from IKEP4_AW_ITEM_READER r 
											where  r.reader_type in ('C','U','G') and r.award_item_id=item.item_id) =0
										then
											#userId#	
										else 
											''
										end
										)	
									or #userId# in ( select AU.user_id from IKEP4_AW_ITEM_READER rdr INNER JOIN IKEP4_EV_GROUP AG ON rdr.reader_id=AG.group_id 
									INNER JOIN IKEP4_EV_USER_GROUP AU ON AG.group_id =AU.group_id where item.item_id=rdr.award_item_id 
									and rdr.reader_type='G' )
									or #userId# = 	
										( CASE WHEN
											(select count(r.reader_id) from IKEP4_AW_ITEM_READER r 
											where  r.reader_type='U' and r.award_item_id=item.item_id and r.reader_id = #userId#) =1
										then
											#userId#	
										else 
											''
										end
										)
									or 	#userId# =	 item.REGISTER_ID 		 
									)
		     			 		</isEqual>
		     			 	</isNotEmpty>
     			 		</isEqual>
     			 	</isNotEmpty>
     			 	<isEmpty property="awardAdminUse">
				     AND ( #userId# in 
								 (
										   select AU.person_id from IKEP4_AW_ITEM_READER  rdr 
										   INNER JOIN IKEP4_AD_ADDRGROUP AG ON rdr.reader_id=AG.addrgroup_id 
										   INNER JOIN IKEP4_AD_PERSON2GROUP AU ON AG.addrgroup_id =AU.addrgroup_id 
										   where item.item_id=rdr.award_item_id and rdr.reader_type='C'
								 
								 )
								 
						or #userId# = 	
							( CASE WHEN
								(select count(r.reader_id) from IKEP4_AW_ITEM_READER r 
								where  r.reader_type in ('C','U','G') and r.award_item_id=item.item_id) =0
							then
								#userId#	
							else 
								''
							end
							)	
						or #userId# in ( select AU.user_id from IKEP4_AW_ITEM_READER rdr INNER JOIN IKEP4_EV_GROUP AG ON rdr.reader_id=AG.group_id 
						INNER JOIN IKEP4_EV_USER_GROUP AU ON AG.group_id =AU.group_id where item.item_id=rdr.award_item_id 
						and rdr.reader_type='G' )
						or #userId# = 	
							( CASE WHEN
								(select count(r.reader_id) from IKEP4_AW_ITEM_READER r 
								where  r.reader_type='U' and r.award_item_id=item.item_id and r.reader_id = #userId#) =1
							then
								#userId#	
							else 
								''
							end
							)
						or 	#userId# =	 item.REGISTER_ID 		 
						)
					</isEmpty>
				 </isEqual>
     			 AND (CURRENT_TIMESTAMP BETWEEN item.START_DATE AND item.END_DATE)
				<isNotEmpty property="searchColumn">
					<isNotEmpty property="searchWord">
						<isEqual property="searchColumn" compareValue="title">
							AND	replace(item.TITLE,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%'
						</isEqual>
						<isEqual property="searchColumn" compareValue="registerName">
							AND (replace(usr.USER_NAME,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%' OR replace(usr.USER_ENGLISH_NAME,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%')
						</isEqual>
						<isEqual property="searchColumn" compareValue="all">
							AND (replace(usr.USER_NAME,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%' OR replace(usr.USER_ENGLISH_NAME,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%' OR replace(item.TITLE,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%') 
						</isEqual>
					</isNotEmpty>
				</isNotEmpty>  
				<isEqual property="admin" compareValue="false">
					<isNotEmpty property="awardAdminUse">
						<isEqual property="awardAdminUse" compareValue="true">
							<isNotEmpty property="awardAdmin">
								<isEqual property="awardAdmin" compareValue="false">
									<![CDATA[   
									AND (CURRENT_TIMESTAMP BETWEEN item.START_DATE AND item.END_DATE   OR   item.REGISTER_ID = #userId# )   
									]]>
								</isEqual>
							</isNotEmpty>
						</isEqual>
					</isNotEmpty>
					<isEmpty property="awardAdminUse">
					     <![CDATA[   
							AND (CURRENT_TIMESTAMP BETWEEN item.START_DATE AND item.END_DATE   OR   item.REGISTER_ID = #userId# )   
							]]>
					</isEmpty>
				</isEqual>				
				 /* ===========================================END  */  
		<![CDATA[   
		    ) A WHERE RNUM <=  #endRowIndex# /* 종료  */
		) TBL WHERE RNUM >  #startRowIndex# /* 시작 */ 
	]]> 
  </select>   
  
  
  <!-- MS SQL -->
  <select id="countBySearchCondition" parameterClass="AwardItemSearchCondition" resultClass="int">  
	SELECT /* [Award_SqlMap.xml] awardItem.countBySearchCondition */ /*+ use_hash (item, usr) */
           COUNT(*)
	FROM   IKEP4_AW_ITEM  item INNER JOIN IKEP4_EV_USER usr
	ON     item.REGISTER_ID = usr.USER_ID   
 	WHERE  
	 	 item.BOARD_ID = #awardId# 
 	AND    item.ITEM_DELETE &lt; 2
 	AND    item.temp_save = '0'

 	AND (CURRENT_TIMESTAMP BETWEEN item.START_DATE AND item.END_DATE)
	<isNotEmpty property="searchColumn">
		<isNotEmpty property="searchWord">
			<isEqual property="searchColumn" compareValue="title">
				AND	replace(item.TITLE,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%'
			</isEqual>
			<isEqual property="searchColumn" compareValue="registerName"> 
				AND (replace(usr.USER_NAME,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%' OR replace(usr.USER_ENGLISH_NAME,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%')
			</isEqual>  
			<isEqual property="searchColumn" compareValue="publisher">
				AND	replace(item.PUBLISHER,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%'
			</isEqual>
			<isEqual property="searchColumn" compareValue="awardTitle">
				AND	replace(item.AWARD_TITLE,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%'
			</isEqual>
			<isEqual property="searchColumn" compareValue="awardTxt">
				AND	replace(item.AWARD_TXT,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%'
			</isEqual>
		</isNotEmpty>
	</isNotEmpty> 
	<isNotEmpty property="searchStorageLocCd">
		and item.STORAGE_LOC_CD = #searchStorageLocCd#
	</isNotEmpty>
	<isNotEmpty property="searchCompanyCode">
		and item.COMPANY_CODE = #searchCompanyCode#
	</isNotEmpty>
	<isNotEmpty property="searchAwardKind">
		and item.AWARD_KIND = #searchAwardKind#
	</isNotEmpty>
	<isNotEmpty property="searchAwardGrade">
		and item.AWARD_GRADE = #searchAwardGrade#
	</isNotEmpty>
	<isNotEmpty property="searchAwardMaterial">
		and item.AWARD_MATERIAL LIKE '%' +#searchAwardMaterial#+ '%'
	</isNotEmpty>
	<isEqual property="admin" compareValue="false">
		<isNotEmpty property="awardAdminUse">
			<isEqual property="awardAdminUse" compareValue="true">
				<isNotEmpty property="awardAdmin">
					<isEqual property="awardAdmin" compareValue="false">
						<![CDATA[   
						AND (CURRENT_TIMESTAMP BETWEEN item.START_DATE AND item.END_DATE   OR   item.REGISTER_ID = #userId# )   
						]]> 
					</isEqual>
				</isNotEmpty>
			</isEqual>
		</isNotEmpty>
		<isEmpty property="awardAdminUse">
		     <![CDATA[   
				AND (CURRENT_TIMESTAMP BETWEEN item.START_DATE AND item.END_DATE   OR   item.REGISTER_ID = #userId# )   
				]]>
		</isEmpty>
	</isEqual>
  </select>  
  
  <select id="deleteCountBySearchCondition" parameterClass="AwardItemSearchCondition" resultClass="int">  
	SELECT /* [Award_SqlMap.xml] awardItem.deleteCountBySearchCondition */ 
           COUNT(*)
	FROM   IKEP4_AW_ITEM  item INNER JOIN IKEP4_EV_USER usr
	ON     item.REGISTER_ID = usr.USER_ID   
	<![CDATA[   
 	WHERE (item.ITEM_DELETE = 1 OR CURRENT_TIMESTAMP > item.END_DATE)
 	and item.award_id in (select bd.award_id from IKEP4_AW_AWARD bd where bd.award_delete = 0)
 	]]> 
	<isNotEmpty property="searchColumn">
		<isNotEmpty property="searchWord">
			<isEqual property="searchColumn" compareValue="title">
				AND	replace(item.TITLE,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%'
			</isEqual>
			<isEqual property="searchColumn" compareValue="registerName"> 
				AND (replace(usr.USER_NAME,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%' OR replace(usr.USER_ENGLISH_NAME,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%')
			</isEqual>  
		</isNotEmpty>
	</isNotEmpty> 
  </select>
  
  <select id="countBySearchCondition2" parameterClass="AwardItemSearchCondition" resultClass="int">  
	SELECT /* [Award_SqlMap.xml] awardItem.countBySearchCondition2 */ /*+ use_hash (item, usr) */
           COUNT(*)
	FROM   IKEP4_AW_ITEM  item INNER JOIN IKEP4_EV_USER usr
	ON     item.REGISTER_ID = usr.USER_ID   
 	WHERE  
	 	 item.BOARD_ID = #awardId# 
 	AND    item.ITEM_DELETE &lt; 2
 	AND    item.temp_save = '0'
	 <isEqual property="admin" compareValue="false">
		<isNotEmpty property="awardAdminUse">
			<isEqual property="awardAdminUse" compareValue="true">
				<isNotEmpty property="awardAdmin">
					<isEqual property="awardAdmin" compareValue="false">
						AND ( #userId# in 
					 (
							   select AU.person_id from IKEP4_AW_ITEM_READER  rdr 
							   INNER JOIN IKEP4_AD_ADDRGROUP AG ON rdr.reader_id=AG.addrgroup_id 
							   INNER JOIN IKEP4_AD_PERSON2GROUP AU ON AG.addrgroup_id =AU.addrgroup_id 
							   where item.item_id=rdr.award_item_id and rdr.reader_type='C'
					 
					 )
					 
					or #userId# = 	
						( CASE WHEN
							(select count(r.reader_id) from IKEP4_AW_ITEM_READER r 
							where  r.reader_type in ('C','U','G') and r.award_item_id=item.item_id) =0
						then
							#userId#	
						else 
							''
						end
						)
					or #userId# in ( select AU.user_id from IKEP4_AW_ITEM_READER rdr INNER JOIN IKEP4_EV_GROUP AG ON rdr.reader_id=AG.group_id 
								INNER JOIN IKEP4_EV_USER_GROUP AU ON AG.group_id =AU.group_id where item.item_id=rdr.award_item_id 
								and rdr.reader_type='G' )
					or #userId# = 	
						( CASE WHEN
							(select count(r.reader_id) from IKEP4_AW_ITEM_READER r 
							where  r.reader_type='U' and r.award_item_id=item.item_id and r.reader_id = #userId#) =1
						then
							#userId#	
						else 
							''
						end
						)
					or 	#userId# =	 item.REGISTER_ID	 		 
				)
					</isEqual>
				</isNotEmpty>
			</isEqual>
		</isNotEmpty>
		<isEmpty property="awardAdminUse">
		    AND ( #userId# in 
					 (
							   select AU.person_id from IKEP4_AW_ITEM_READER  rdr 
							   INNER JOIN IKEP4_AD_ADDRGROUP AG ON rdr.reader_id=AG.addrgroup_id 
							   INNER JOIN IKEP4_AD_PERSON2GROUP AU ON AG.addrgroup_id =AU.addrgroup_id 
							   where item.item_id=rdr.award_item_id and rdr.reader_type='C'
					 
					 )
					 
			or #userId# = 	
				( CASE WHEN
					(select count(r.reader_id) from IKEP4_AW_ITEM_READER r 
					where  r.reader_type in ('C','U','G') and r.award_item_id=item.item_id) =0
				then
					#userId#	
				else 
					''
				end
				)
			or #userId# in ( select AU.user_id from IKEP4_AW_ITEM_READER rdr INNER JOIN IKEP4_EV_GROUP AG ON rdr.reader_id=AG.group_id 
						INNER JOIN IKEP4_EV_USER_GROUP AU ON AG.group_id =AU.group_id where item.item_id=rdr.award_item_id 
						and rdr.reader_type='G' )
			or #userId# = 	
				( CASE WHEN
					(select count(r.reader_id) from IKEP4_AW_ITEM_READER r 
					where  r.reader_type='U' and r.award_item_id=item.item_id and r.reader_id = #userId#) =1
				then
					#userId#	
				else 
					''
				end
				)
			or 	#userId# =	 item.REGISTER_ID	 		 
			)
		</isEmpty>
	</isEqual>
 	AND (CURRENT_TIMESTAMP BETWEEN item.START_DATE AND item.END_DATE)
	<isNotEmpty property="searchColumn">
		<isNotEmpty property="searchWord">
			<isEqual property="searchColumn" compareValue="title">
				AND	replace(item.TITLE,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%'
			</isEqual>
			<isEqual property="searchColumn" compareValue="registerName"> 
				AND (replace(usr.USER_NAME,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%' OR replace(usr.USER_ENGLISH_NAME,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%')
			</isEqual>  
		</isNotEmpty>
	</isNotEmpty> 
	<isEqual property="admin" compareValue="false">
	<isNotEmpty property="awardAdminUse">
		<isEqual property="awardAdminUse" compareValue="true">
			<isNotEmpty property="awardAdmin">
				<isEqual property="awardAdmin" compareValue="false">
					<![CDATA[   
				AND (CURRENT_TIMESTAMP BETWEEN item.START_DATE AND item.END_DATE   OR   item.REGISTER_ID = #userId# )   
				]]> 
				</isEqual>
			</isNotEmpty>
		</isEqual>
	</isNotEmpty>
	<isEmpty property="awardAdminUse">
	    <![CDATA[   
				AND (CURRENT_TIMESTAMP BETWEEN item.START_DATE AND item.END_DATE   OR   item.REGISTER_ID = #userId# )   
				]]> 
	</isEmpty>
	</isEqual>
  </select> 
  
  <select id="countBySearchCondition3" parameterClass="AwardItemSearchCondition" resultClass="int">  
	SELECT /* [Award_SqlMap.xml] awardItem.countBySearchCondition3 */ /*+ use_hash (item, usr) */
           COUNT(*)
	FROM   IKEP4_AW_ITEM  item INNER JOIN IKEP4_EV_USER usr
	ON     item.REGISTER_ID = usr.USER_ID   
 	WHERE  
	 	 item.BOARD_ID = #awardId# 
 	AND    item.ITEM_DELETE &lt; 2
 	AND    item.temp_save = '0'
 	<isNotEmpty property="searchMaterial">
	 	AND  item_id in ( 
	 		select item_id from ikep4_aw_material
			where material in(<iterate property="searchMaterials" conjunction=","> #searchMaterials[]# </iterate>)
		)
 	</isNotEmpty>
 	AND (CURRENT_TIMESTAMP BETWEEN item.START_DATE AND item.END_DATE)
	<isNotEmpty property="searchColumn">
		<isNotEmpty property="searchWord">
			<isEqual property="searchColumn" compareValue="title">
				AND	replace(item.TITLE,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%'
			</isEqual>
			<isEqual property="searchColumn" compareValue="registerName"> 
				AND (replace(usr.USER_NAME,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%' OR replace(usr.USER_ENGLISH_NAME,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%')
			</isEqual>  
			<isEqual property="searchColumn" compareValue="publisher">
				AND	replace(item.PUBLISHER,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%'
			</isEqual>
			<isEqual property="searchColumn" compareValue="awardTitle">
				AND	replace(item.AWARD_TITLE,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%'
			</isEqual>
			<isEqual property="searchColumn" compareValue="awardTxt">
				AND	replace(item.AWARD_TXT,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%'
			</isEqual>
		</isNotEmpty>
	</isNotEmpty> 
	<isNotEmpty property="searchStorageLocCd">
		and item.STORAGE_LOC_CD = #searchStorageLocCd#
	</isNotEmpty>
	<isNotEmpty property="searchCompanyCode">
		and item.COMPANY_CODE = #searchCompanyCode#
	</isNotEmpty>
	<isNotEmpty property="searchAwardKind">
		and item.AWARD_KIND = #searchAwardKind#
	</isNotEmpty>
	<isNotEmpty property="searchAwardGrade">
		and item.AWARD_GRADE = #searchAwardGrade#
	</isNotEmpty>
	<isNotEmpty property="searchAwardMaterial">
		and item.AWARD_MATERIAL LIKE '%' +#searchAwardMaterial#+ '%'
	</isNotEmpty>
	<isNotEmpty property="endPeriod">
	<![CDATA[
	AND item.award_date <=  #endPeriod#
	]]>	
	</isNotEmpty>
	<isNotEmpty property="startPeriod">
	<![CDATA[
	AND item.award_date >=  #startPeriod#
	]]>	
	</isNotEmpty>
	<isEqual property="admin" compareValue="false">
	<isNotEmpty property="awardAdminUse">
		<isEqual property="awardAdminUse" compareValue="true">
			<isNotEmpty property="awardAdmin">
				<isEqual property="awardAdmin" compareValue="false">
					<![CDATA[   
					AND (CURRENT_TIMESTAMP BETWEEN item.START_DATE AND item.END_DATE   OR   item.REGISTER_ID = #userId# )   
					]]> 
				</isEqual>
			</isNotEmpty>
		</isEqual>
	</isNotEmpty>
	<isEmpty property="awardAdminUse">
	     <![CDATA[   
		AND (CURRENT_TIMESTAMP BETWEEN item.START_DATE AND item.END_DATE   OR   item.REGISTER_ID = #userId# )   
		]]> 
	</isEmpty>
	</isEqual>
  </select> 
  <!-- ANSI -->
  <select id="countChildren" parameterClass="String" resultClass="int">  
	SELECT /* [Award_SqlMap.xml] awardItem.countChildren */ 
           COUNT(*)
	FROM   IKEP4_AW_ITEM
    WHERE  ITEM_PARENT_ID = #itemId#  
    AND    ITEM_DELETE &lt; 2
  </select> 
  
  <!-- MS SQL -->
  <insert id="create" parameterClass="AwardItem"> 
    INSERT INTO IKEP4_AW_ITEM ( /* [awardItem_SqlMap.xml] AwardItem.insert */
     <include refid="lightpack.award.dao.awardItem.sqlColumnList" />
     ) VALUES (
      #itemId#, 
      #awardId#, 
      #itemParentId#, 
      #itemGroupId#, 
      #step#, 
      #indentation#, 
      #itemSeqId#,  
      #itemDisplay#, 
      #title#, 
      #hitCount#, 
      #recommendCount#, 
      #replyCount#, 
      #linereplyCount#, 
      #attachFileCount#,
      #startDate#, 
      #endDate#, 
      #itemDelete#, 
      #imageFileId#,
      #contents#,
      #registerId#, 
      #registerName#, 
      CURRENT_TIMESTAMP, 
      #updaterId#, 
      #updaterName#,
      CURRENT_TIMESTAMP,
      #tempSave#,
      #wordId#, 
      #wordName#,
      #itemForever#,
      #readerMailFlag#,
      #disStartDate#,
      #disEndDate#,
      #displayName#,
      #awardKind#,			
		#companyCode#,			
		#awardTitle#,			
		#awardTxt#,			
		#publisher#,			
		#awardDate#,			
		#awardGrade#,			
		#awardMaterial#,			
		#storageLocCd#,			
		#storageLocDetail#,		
		#resDeptId#,			
		#awardPromotionDetail#,		
		#writeEmpNo#,
		#awardMaterials#	 
    ) 
     <selectKey resultClass="string" keyProperty="itemSeqId" type="pre">  
     <![CDATA[
		declare @seq numeric(38)
		exec GET_SEQUENCE_FROM_SEQ_IKEP4_BD_ITEM 2, @seq OUTPUT
       	SELECT @seq
     ]]>
     </selectKey>
  </insert>
    
  <!-- ANSI -->
  <update id="update" parameterClass="AwardItem"> 
    UPDATE IKEP4_AW_ITEM /* [AwardItem_SqlMap.xml] awardItem.update */
    SET   <isNotEmpty property="awardId"         >BOARD_ID          = #awardId#,        </isNotEmpty>
          <isNotEmpty property="itemParentId"    >ITEM_PARENT_ID    = #itemParentId#,   </isNotEmpty>
          <isNotEmpty property="itemGroupId"     >ITEM_GROUP_ID     = #itemGroupId#,    </isNotEmpty>
          <isNotEmpty property="step"            >STEP              = #step#,           </isNotEmpty>
          <isNotEmpty property="indentation"     >INDENTATION       = #indentation#,    </isNotEmpty>
          <isNotEmpty property="itemSeqId"       >ITEM_SEQ_ID       = #itemSeqId#,      </isNotEmpty>
          <isNotEmpty property="itemDisplay"     >ITEM_DISPLAY      = #itemDisplay#,    </isNotEmpty>
          <isNotEmpty property="title"           >TITLE             = #title#,          </isNotEmpty>
          <isNotEmpty property="hitCount"        >HIT_COUNT         = #hitCount#,       </isNotEmpty>
          <isNotEmpty property="recommendCount"  >RECOMMEND_COUNT   = #recommendCount#, </isNotEmpty>
          <isNotEmpty property="replyCount"      >REPLY_COUNT       = #replyCount#,     </isNotEmpty>
          <isNotEmpty property="linereplyCount"  >LINEREPLY_COUNT   = #linereplyCount#, </isNotEmpty>
          <isNotEmpty property="attachFileCount" >ATTACH_FILE_COUNT = #attachFileCount#,</isNotEmpty>
          <isNotEmpty property="startDate"       >START_DATE        = #startDate#,      </isNotEmpty>
          <isNotEmpty property="endDate"         >END_DATE          = #endDate#,        </isNotEmpty>
          <isNotEmpty property="disStartDate"       >DIS_START_DATE        = #disStartDate#,      </isNotEmpty>
          <isNotEmpty property="disEndDate"         >DIS_END_DATE          = #disEndDate#,        </isNotEmpty>
          <isNotEmpty property="itemDelete"      >ITEM_DELETE       = #itemDelete#,     </isNotEmpty>
          <isNotEmpty property="imageFileId"     >IMAGE_FILE_ID     = #imageFileId#,    </isNotEmpty>
          <isNotEmpty property="contents"        >CONTENTS          = #contents#,       </isNotEmpty>
          <isNotEmpty property="readerMailFlag"  >READER_MAIL_FLAG  = #readerMailFlag#, </isNotEmpty>
 
			UPDATER_ID        = #updaterId#,
			UPDATER_NAME      = #updaterName#,
			UPDATE_DATE       = CURRENT_TIMESTAMP,
			TEMP_SAVE			= #tempSave#,
			WORD_ID           = #wordId#,
			WORD_NAME         = #wordName#,
			ITEM_FOREVER      = #itemForever#,
			DISPLAY_NAME		= #displayName#,
			AWARD_KIND		= #awardKind#,			
			COMPANY_CODE		= #companyCode#,			
			AWARD_TITLE		= #awardTitle#,			
			AWARD_TXT		= #awardTxt#,			
			PUBLISHER		= #publisher#,			
			AWARD_DATE		= #awardDate#,			
			AWARD_GRADE		= #awardGrade#,			
			AWARD_MATERIAL		= #awardMaterial#,			
			STORAGE_LOC_CD		= #storageLocCd#,			
			STORAGE_LOC_DETAIL		= #storageLocDetail#,		
			RES_DEPT_ID		= #resDeptId#,			
			AWARD_PROMOTION_DETAIL		= #awardPromotionDetail#,		
			WRITE_EMP_NO		= #writeEmpNo#,
			AWARD_MATERIALS		= #awardMaterials#	
    WHERE ITEM_ID = #itemId# 
  </update>
  
  <!-- ANSI -->
  <update id="logicalDelete" parameterClass="AwardItem"> 
    UPDATE IKEP4_AW_ITEM /* [AwardItem_SqlMap.xml] awardItem.logicalDelete */
    SET    ITEM_DELETE = 1,
           UPDATER_ID          = #updaterId#,
           UPDATER_NAME        = #updaterName#,
           UPDATE_DATE         = CURRENT_TIMESTAMP   
    WHERE ITEM_ID = #itemId# 
  </update>

  <!-- ANSI -->  
  <update id="updateStep" parameterClass="AwardItem"> 
    UPDATE IKEP4_AW_ITEM /* [AwardItem_SqlMap.xml] awardItem.updateStep */
    SET   STEP = STEP + 1 
    WHERE ITEM_GROUP_ID = #itemGroupId# 
    AND   STEP >= #step#  
  </update>

  <!-- ANSI --> 
  <update id="updateRecommendCount" parameterClass="string">
    UPDATE IKEP4_AW_ITEM /* [AwardItem_SqlMap.xml] awardItem.updateRecommendCount */
    SET    RECOMMEND_COUNT = RECOMMEND_COUNT + 1
    WHERE ITEM_ID = #itemId# 
  </update> 

  <!-- ANSI -->  
  <update id="updateItemDeleteField" parameterClass="map">
    UPDATE IKEP4_AW_ITEM /* [AwardItem_SqlMap.xml] awardItem.updateItemDeleteField */
    SET    ITEM_DELETE = #status#
    WHERE  ITEM_ID = #itemId# 
  </update> 

  <!-- ANSI -->  
  <update id="updateLinereplyCount" parameterClass="string">
    UPDATE IKEP4_AW_ITEM /* [AwardItem_SqlMap.xml] awardItem.updateLinereplyCount */
    SET    LINEREPLY_COUNT = (SELECT COUNT(*) FROM IKEP4_AW_LINEREPLY WHERE ITEM_ID = #itemId#)
    WHERE ITEM_ID = #itemId# 
  </update> 

  <!-- ANSI -->   
  <update id="updateReplyCount" parameterClass="string">
    UPDATE IKEP4_AW_ITEM /* [AwardItem_SqlMap.xml] awardItem.updateReplyCount */
    SET    REPLY_COUNT = (SELECT COUNT(*) FROM IKEP4_AW_ITEM WHERE ITEM_PARENT_ID = #itemId# AND ITEM_DELETE &lt; 2) 
    WHERE  ITEM_ID = #itemId# 
  </update>

  <!-- ANSI -->  
  <update id="updateHitCount" parameterClass="String"> 
    UPDATE IKEP4_AW_ITEM /* [AwardItem_SqlMap.xml] awardItem.updateHitCount */
    SET    HIT_COUNT = HIT_COUNT + 1
    WHERE ITEM_ID = #itemId# 
  </update> 
  
  <!-- ANSI -->  
  <delete id="physicalDelete" parameterClass="string"> 
    DELETE FROM IKEP4_AW_ITEM /* [AwardItem_SqlMap.xml] awardItem.physicalDelete */
    WHERE ITEM_ID = #itemId# 
  </delete>    
  
  <delete id="deleteAwardItemMaterial" parameterClass="string"> 
    DELETE FROM ikep4_aw_material 
    WHERE ITEM_ID = #itemId# 
  </delete> 
  <insert id="saveAwardItemMaterial" parameterClass="AwardItem"> 
  	INSERT 
	INTO      ikep4_aw_material(item_id, material)
	 select #itemId#, com_nm from TB_COMMON_CODE
	where grp_cd = 'C00017'
	and com_cd = #awardMaterial#
  </insert>
  
  <!-- MS SQL -->
  <delete id="physicalDeleteThread" parameterClass="string">  
  	WITH CTE AS (
  		SELECT	ITEM_ID 
		FROM	IKEP4_AW_ITEM
		WHERE	ITEM_ID =  #itemId#
		UNION ALL
		SELECT	TBL.ITEM_ID 
		FROM	IKEP4_AW_ITEM TBL, CTE
		WHERE	CTE.ITEM_ID = TBL.ITEM_PARENT_ID
  	)
 	DELETE FROM  IKEP4_AW_ITEM /* [AwardItem_SqlMap.xml] awardItem.physicalDeleteThread */
 	WHERE  ITEM_ID IN ( 
	      	SELECT ITEM_ID FROM CTE
	)   
  </delete> 
  
    <update id="updateMailCount" parameterClass="string">
	   UPDATE IKEP4_AW_ITEM 		/* [AwardItem_SqlMap.xml] awardItem.updateMailCount */
	   SET MAIL_COUNT = MAIL_COUNT + 1
	   WHERE ITEM_ID = #itemId#
	</update>
	
	<update id="updateMblogCount" parameterClass="string">
	   UPDATE IKEP4_AW_ITEM 		/* [AwardItem_SqlMap.xml] awardItem.updateMblogCount */
	   SET MBLOG_COUNT = MBLOG_COUNT + 1
	   WHERE  ITEM_ID = #itemId#
	</update>
	
	<update id="updateAwardItemMove" parameterClass="Map"> 
		UPDATE IKEP4_AW_ITEM 
		SET   
			BOARD_ID		=	#targetAwardId#,
			UPDATER_ID		=	#updaterId#,
			UPDATER_NAME	=	#updaterName#,
			UPDATE_DATE		=	CURRENT_TIMESTAMP
		WHERE 
			ITEM_ID = #itemId# 
			AND BOARD_ID=#orgAwardId#
	</update>
	
	<select id="listRecentAwardItemPortlet" parameterClass="map" resultMap="awardItemResultExtend">
	    SELECT  /* [AwardItem_SqlMap.xml] ightpack.award.dao.AwardItemDao.listRecentAwardItemPortlet */ *
		FROM 
		(
		SELECT Row_number() OVER (ORDER BY item.START_DATE DESC, item.REGIST_DATE DESC) AS RNUM,
			<include refid="lightpack.award.dao.awardItem.sqlExtendColumnList" /> 
		FROM  
			IKEP4_AW_ITEM item INNER JOIN IKEP4_EV_USER usr
	        ON    item.REGISTER_ID = usr.USER_ID  
	    <![CDATA[  
		WHERE  
			item.BOARD_ID = #awardId#
		)  TBL
		WHERE
			RNUM <= #count#
		]]>  
    </select>  	
	
	<!-- select id="listRecentAwardItemPortlet" parameterClass="map" resultMap="awardItemResultExtend">
	/* [AwardItem_SqlMap.xml] awardItem.listRecentAwardItemPortlet */
	SELECT *
      FROM (
		    SELECT 
		    	<include refid="lightpack.award.dao.awardItem.sqlExtendColumnList" />
			FROM IKEP4_AW_ITEM item	INNER JOIN 
				 IKEP4_EV_USER usr ON item.REGISTER_ID = usr.USER_ID
	<![CDATA[  
			WHERE item.BOARD_ID = #awardId#
			  AND STEP = 0 
			  AND item.ITEM_DELETE = 0 
			  AND SYSDATE BETWEEN item.START_DATE AND item.END_DATE
			ORDER BY START_DATE DESC, REGIST_DATE DESC
    		)
    WHERE ROWNUM <= #count# 
    ]]>
  </select-->
  
  <select id="countTempSaveBySearchCondition" parameterClass="AwardItemSearchCondition" resultClass="int">
  	SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED  
	SELECT /* [Award_SqlMap.xml] awardItem.countTempSaveBySearchCondition */
           COUNT(*)
	  FROM   IKEP4_AW_AWARD award INNER JOIN 
	  		 IKEP4_AW_ITEM  item ON award.award_id = item.award_id INNER JOIN 
	  		 IKEP4_EV_USER usr ON item.REGISTER_ID = usr.USER_ID   
 	 WHERE item.temp_save = '1'
 	   AND award.award_delete = 0
 	   AND item.ITEM_DELETE &lt; 2
 	   AND item.REGISTER_ID = #userId#
	<isNotEmpty property="searchColumn">
		<isNotEmpty property="searchWord">
			<isEqual property="searchColumn" compareValue="title">
				AND	replace(item.TITLE,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%'
			</isEqual>
		</isNotEmpty>
	</isNotEmpty> 
  </select>
  
  <select id="listTempSaveBySearchCondition" parameterClass="AwardItemSearchCondition" resultMap="awardItemResultExtendNonContents">
  SELECT /* [AwardItem_SqlMap.xml] awardItem.listBySearchCondition */ 
        *
  FROM (
		     SELECT A.* FROM ( 
		         /* START========================================= */
		         SELECT Row_number() OVER (ORDER BY
												<isNotEmpty property="sortColumn">
													<isEqual property="sortColumn" compareValue="ITEM_SEQ_ID">
														<isEqual property="sortType" compareValue="DESC">
															item.ITEM_SEQ_ID DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.ITEM_SEQ_ID ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="ATTACH_FILE_COUNT">
														<isEqual property="sortType" compareValue="DESC">
															item.ATTACH_FILE_COUNT DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.ATTACH_FILE_COUNT ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="TITLE">
														<isEqual property="sortType" compareValue="DESC">
															item.TITLE DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.TITLE ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="REGISTER_NAME">
														<isEqual property="sortType" compareValue="DESC">
															item.REGISTER_NAME DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.REGISTER_NAME ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="START_DATE">
														<isEqual property="sortType" compareValue="DESC">
															item.START_DATE DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.START_DATE ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="HIT_COUNT">
														<isEqual property="sortType" compareValue="DESC">
															item.HIT_COUNT DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.HIT_COUNT ASC,
														</isEqual>
													</isEqual> 
													<isEqual property="sortColumn" compareValue="RECOMMEND_COUNT">
														<isEqual property="sortType" compareValue="DESC">
															item.RECOMMEND_COUNT DESC,
														</isEqual>
														<isEqual property="sortType" compareValue="ASC">
															item.RECOMMEND_COUNT ASC,
														</isEqual>
													</isEqual> 
												</isNotEmpty>  
											    item.ITEM_DISPLAY DESC, item.ITEM_GROUP_ID DESC, item.STEP ASC	) AS RNUM,
		         		<include refid="lightpack.award.dao.awardItem.sqlExtendColumnListNonContents" /> 
		         FROM   IKEP4_AW_AWARD award 
		         INNER JOIN IKEP4_AW_ITEM item ON award.award_id = item.award_id
		         INNER JOIN IKEP4_EV_USER usr  ON item.REGISTER_ID = usr.USER_ID 
				 WHERE  item.ITEM_DELETE &lt; 2
				 AND    award.award_delete = 0
     			 AND 	item.temp_save = '1'
				<isNotEmpty property="searchColumn">
					<isNotEmpty property="searchWord">
						<isEqual property="searchColumn" compareValue="title">
							AND	replace(item.TITLE,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%'
						</isEqual>
						<isEqual property="searchColumn" compareValue="registerName">
							AND (replace(usr.USER_NAME,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%' OR replace(usr.USER_ENGLISH_NAME,' ','') LIKE '%' + replace(#searchWord#,' ','') + '%')
						</isEqual>
					</isNotEmpty>
				</isNotEmpty>  
				<isNotEmpty property="admin">
					<isEqual property="admin" compareValue="false">
						<![CDATA[   
						AND (CURRENT_TIMESTAMP BETWEEN item.START_DATE AND item.END_DATE   AND   item.REGISTER_ID = #userId# )   
						]]>
					</isEqual>	
				</isNotEmpty>		
				<isEmpty property="admin">
					<![CDATA[   
					AND (CURRENT_TIMESTAMP BETWEEN item.START_DATE AND item.END_DATE   AND   item.REGISTER_ID = #userId# )   
					]]>
				</isEmpty>	
				 /* ===========================================END  */  
		<![CDATA[   
		    ) A WHERE RNUM <=  #endRowIndex# /* 종료  */
		) TBL WHERE RNUM >  #startRowIndex# /* 시작 */ 
	]]> 
  </select>  
  	<select id="getMailWaitYn" parameterClass="String" resultClass="int">
	<![CDATA[
		select count(*) from IKEP4_AW_ITEM
		where reader_mail_flag = 1
		and temp_save = 0
		and item_id = #itemId#
		and 
		(
		(substring(convert(varchar, update_date, 108),4,2) >= 0 and substring(convert(varchar, update_date, 108),4,2) < 20
		and substring(convert(varchar, getdate(), 108),4,2) >= 0 and substring(convert(varchar, getdate(), 108),4,2) < 20)
		or
		(substring(convert(varchar, update_date, 108),4,2) >= 20 and substring(convert(varchar, update_date, 108),4,2) < 40
		and substring(convert(varchar, getdate(), 108),4,2) >= 20 and substring(convert(varchar, getdate(), 108),4,2) < 40)
		or
		(substring(convert(varchar, update_date, 108),4,2) >= 40 and substring(convert(varchar, update_date, 108),4,2) < 60
		and substring(convert(varchar, getdate(), 108),4,2) >= 40 and substring(convert(varchar, getdate(), 108),4,2) < 60)
		)
	]]>
	</select>
	
	<select id="getAwardItemCount" parameterClass="AwardItem" resultClass="int">
	<![CDATA[
		select count(*) from IKEP4_AW_ITEM A
		where A.award_id = #awardId#
		AND A.register_id != #registerId#
		AND A.ITEM_ID NOT IN (SELECT B.ITEM_ID FROM IKEP4_AW_REFERENCE B WHERE B.REGISTER_ID = #registerId#)
		AND (A.ITEM_ID IN(select C.award_item_id from IKEP4_AW_ITEM_READER C
		where C.reader_id in(
		select D.addrgroup_id from IKEP4_AD_PERSON2GROUP D
		where D.person_id = #registerId#)) OR A.ITEM_ID NOT IN (select E.award_item_id from IKEP4_AW_ITEM_READER E))
		AND A.regist_date > '20140911'
		AND A.ITEM_DELETE = '0'
		AND A.TEMP_SAVE = '0'
		AND current_timestamp BETWEEN A.start_date AND A.end_date
	]]>
	</select>
	
	<select id="getHappyAwardItemCount" parameterClass="AwardItem" resultClass="int">
	
		select count(*) from IKEP4_AW_ITEM A
		where A.award_id = #awardId#
		AND A.register_id != #registerId#
		AND A.ITEM_ID NOT IN (SELECT B.ITEM_ID FROM IKEP4_AW_REFERENCE B WHERE B.REGISTER_ID = #registerId#)
		AND (A.ITEM_ID IN(select C.award_item_id from IKEP4_AW_ITEM_READER C
		where C.reader_id in(
		select D.addrgroup_id from IKEP4_AD_PERSON2GROUP D
		where D.person_id = #registerId#)) OR A.ITEM_ID NOT IN (select E.award_item_id from IKEP4_AW_ITEM_READER E))
		
		<![CDATA[
		AND A.regist_date > '20140911'
		AND A.ITEM_DELETE = '0'
		AND A.TEMP_SAVE = '0'
		AND current_timestamp BETWEEN A.start_date AND A.end_date
		]]>
	</select>
	
	<update id="updateMailWaitYn" parameterClass="String">
		UPDATE IKEP4_AW_ITEM SET READER_MAIL_FLAG=0 WHERE ITEM_ID = #itemId#
	</update>
	
  	<!-- updateMailSent -->
	<update id="updateMailSent">
		UPDATE IKEP4_AW_ITEM SET READER_MAIL_FLAG=0 WHERE ITEM_ID IN
	       <iterate open="(" close=")" conjunction=",">
	       		#[]#
	       </iterate>	
	</update>   
	<select id="getMailWaitTime" parameterClass="String" resultClass="int">
	<![CDATA[
		select top 1 datediff(mi, update_date, getdate()) 
		from IKEP4_AW_ITEM
		where reader_mail_flag = '1'
		and temp_save=0
		order by update_date desc
	]]>
	</select>
	
	<select id="getMailWaitCount" parameterClass="String" resultClass="int">
	<![CDATA[
		select count(*)
		from IKEP4_AW_ITEM
		where reader_mail_flag = '1'
		and temp_save=0
	]]>
	</select>
	
	<select id="getOtherItem" parameterClass="map" resultMap="awardItemResultExtend"> 
    SELECT /* [AwardItem_SqlMap.xml] awardItem.getOtherItem */
          <include refid="lightpack.award.dao.awardItem.sqlExtendColumnList" /> 
	FROM  IKEP4_AW_ITEM item INNER JOIN IKEP4_EV_USER usr
	ON    item.REGISTER_ID = usr.USER_ID
    <isEqual property="readFlag" compareValue="prev">
    <![CDATA[ 
	WHERE item.ITEM_ID = 
		(SELECT TOP 1 ITEM_ID 
		 FROM IKEP4_AW_ITEM 
		 WHERE ITEM_ID IN ( SELECT MAX(ITEM_ID) FROM IKEP4_AW_ITEM WHERE board_id=#awardId# AND ITEM_ID < #itemId# )
		)
	]]>
	</isEqual>
	<isEqual property="readFlag" compareValue="next">
	<![CDATA[ 
	WHERE item.ITEM_ID = 
		(SELECT TOP 1 ITEM_ID 
		 FROM IKEP4_AW_ITEM 
		 WHERE ITEM_ID IN ( SELECT MIN(ITEM_ID) FROM IKEP4_AW_ITEM WHERE board_id=#awardId# AND ITEM_ID > #itemId# )
		)
	]]>
	</isEqual>
     
    </select>
    
    <select id="countAwardMenuList" resultClass="int"> 
    /* [Award_SqlMap.xml] lightpack.award.dao.awarditem.getAwardMenuList */		
  	SELECT 
		COUNT(*)
	FROM  IKEP4_AW_AWARD 
	WHERE  BOARD_TYPE != 2
	AND		  BOARD_DELETE = 0
    </select>
    
    <select id="getAwardMenuList" resultMap="awardMenuResult"> 
    /* [Award_SqlMap.xml] lightpack.award.dao.awarditem.getAwardMenuList */		
  	SELECT 
		ROW_NUMBER() OVER(ORDER BY BOARD_PARENT_ID) AS NUM,
	    BOARD_ID,
	    BOARD_NAME,
	    TYPE = 'BOARD'
	FROM  IKEP4_AW_AWARD 
	WHERE  BOARD_TYPE != 2
	AND		  BOARD_DELETE = 0
    </select>
    
    <select id="getPresentAwardMenuList" parameterClass="String" resultMap="presentAwardMenuResult"> 
    /* [Award_SqlMap.xml] lightpack.award.dao.awarditem.getAwardMenuList */		
  	SELECT * 
  	FROM		IKEP4_CO_MENULIST_MOBILE
  	WHERE 	USER_ID = #userId# 
  	AND 		TYPE = 'BOARD'
    </select>
    
    <delete id="deleteAwardMenuList" parameterClass="String">
    DELETE 
    FROM 		IKEP4_CO_MENULIST_MOBILE
    WHERE		USER_ID = #userId#
    AND 		TYPE = 'BOARD'
    </delete>
    
    <insert id="insertAwardMenuList" parameterClass="Map">
	INSERT 
	INTO      IKEP4_CO_MENULIST_MOBILE
	VALUES ( #itemId#,#userId#,'BOARD', GetDate())
	</insert>
</sqlMap> 