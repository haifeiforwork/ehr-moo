<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="support.customer.dao.finance">

<typeAlias alias="FinanceSearchCondition" type="com.lgcns.ikep4.support.customer.search.FinanceSearchCondition"/>
<typeAlias alias="Finance" type="com.lgcns.ikep4.support.customer.model.Finance"/>
<typeAlias alias="FinanceCondition" type="com.lgcns.ikep4.support.customer.model.FinanceCondition"/>
<typeAlias alias="MainPerson" type="com.lgcns.ikep4.support.customer.model.MainPerson"/>
<typeAlias alias="PersonStatic" type="com.lgcns.ikep4.support.customer.model.PersonStatic"/>
<typeAlias alias="MainBusiness" type="com.lgcns.ikep4.support.customer.model.MainBusiness"/>
<typeAlias alias="RelationCompany" type="com.lgcns.ikep4.support.customer.model.RelationCompany"/>
<typeAlias alias="BuyingInfo" type="com.lgcns.ikep4.support.customer.model.BuyingInfo"/>
<typeAlias alias="CustomerBasicInfo" type="com.lgcns.ikep4.util.model.CustomerBasicInfo"/>
<typeAlias alias="CustomerBuyingInfo" type="com.lgcns.ikep4.util.model.CustomerBuyingInfo"/>

<resultMap class="Finance" id="FinanceResult">
	<result column="ROWNUM" 			property="rowNum" />
	<result column="ID" 				property="id" />
	<result column="NAME" 				property="name" />
	<result column="REGISTER_ID" 	    property="registerId"   	 />
	<result column="REGISTER_NAME"  	property="registerName" 	 />	
    <result column="REGIST_DATE"    	property="registDate" 	     />		
    <result column="HIT_COUNT"    	property="hitCount" 	     />		
</resultMap>

<resultMap class="Finance" id="profitLossResult">
	<result column="ID" 				property="id" />
    <result column="YEAR_INFO"    	property="yearInfo" 	     />
	<result column="MNT1"    	property="mnt1" 	     />  
	<result column="MNT2"    	property="mnt2" 	     />
	<result column="MNT3"    	property="mnt3" 	     />
	<result column="MNT4"    	property="mnt4" 	     />
	<result column="MNT5"    	property="mnt5" 	     />
	<result column="MNT6"    	property="mnt6" 	     />
	<result column="MNT7"    	property="mnt7" 	     />
	<result column="MNT8"    	property="mnt8" 	     />
	<result column="MNT9"    	property="mnt9" 	     />
	<result column="MNT10"    	property="mnt10" 	     />
	<result column="MNT11"    	property="mnt11" 	     />
	<result column="MNT12"    	property="mnt12" 	     />
	<result column="MNT13"    	property="mnt13" 	     />
	<result column="MNT14"    	property="mnt14" 	     />
	<result column="MNT15"    	property="mnt15" 	     />
	<result column="MNT16"    	property="mnt16" 	     />
	<result column="MNT17"    	property="mnt17" 	     />
	<result column="CUSTOMER_INFO_ID"    	property="customerInfoId" 	     />
	<result column="CUSTOMER_INFO_NAME"    	property="customerInfoName" 	     />
	<result column="DIV_INFO"    	property="divInfo" 	     />
</resultMap>

<resultMap class="FinanceCondition" id="conditionResult">
	<result column="ID" 				property="id" />
    <result column="YEAR_INFO"    	property="yearInfo" 	     />
	<result column="MNT1"    	property="mnt1" 	     />  
	<result column="MNT2"    	property="mnt2" 	     />
	<result column="MNT3"    	property="mnt3" 	     />
	<result column="MNT4"    	property="mnt4" 	     />
	<result column="MNT5"    	property="mnt5" 	     />
	<result column="MNT6"    	property="mnt6" 	     />
	<result column="MNT7"    	property="mnt7" 	     />
	<result column="MNT8"    	property="mnt8" 	     />
	<result column="MNT9"    	property="mnt9" 	     />
	<result column="MNT10"    	property="mnt10" 	     />
	<result column="MNT11"    	property="mnt11" 	     />
	<result column="MNT12"    	property="mnt12" 	     />
	<result column="MNT13"    	property="mnt13" 	     />
	<result column="MNT14"    	property="mnt14" 	     />
	<result column="MNT15"    	property="mnt15" 	     />
	<result column="MNT16"    	property="mnt16" 	     />
	<result column="MNT17"    	property="mnt17" 	     />
	<result column="MNT18"    	property="mnt18" 	     />
	<result column="MNT19"    	property="mnt19" 	     />
	<result column="MNT20"    	property="mnt20" 	     />
	<result column="MNT21"    	property="mnt21" 	     />
	<result column="MNT22"    	property="mnt22" 	     />
	<result column="MNT23"    	property="mnt23" 	     />
	<result column="MNT24"    	property="mnt24" 	     />
	<result column="MNT25"    	property="mnt25" 	     />
	<result column="MNT26"    	property="mnt26" 	     />
	<result column="MNT27"    	property="mnt27" 	     />
	<result column="MNT28"    	property="mnt28" 	     />
	<result column="MNT29"    	property="mnt29" 	     />
	<result column="CUSTOMER_INFO_ID"    	property="customerInfoId" 	     />
	<result column="CUSTOMER_INFO_NAME"    	property="customerInfoName" 	     />
	<result column="DIV_INFO"    	property="divInfo" 	     />
</resultMap>

<resultMap class="Finance" id="rateResult">
	<result column="ID" 				property="id" />
    <result column="YEAR_INFO"    	property="yearInfo" 	     />
	<result column="MNT1"    	property="mnt1" 	     />  
	<result column="MNT2"    	property="mnt2" 	     />
	<result column="MNT3"    	property="mnt3" 	     />
	<result column="MNT4"    	property="mnt4" 	     />
	<result column="MNT5"    	property="mnt5" 	     />
	<result column="MNT6"    	property="mnt6" 	     />
	<result column="MNT7"    	property="mnt7" 	     />
	<result column="MNT8"    	property="mnt8" 	     />
	<result column="MNT9"    	property="mnt9" 	     />
	<result column="MNT10"    	property="mnt10" 	     />
	<result column="MNT11"    	property="mnt11" 	     />
	<result column="MNT12"    	property="mnt12" 	     />
	<result column="CUSTOMER_INFO_ID"    	property="customerInfoId" 	     />
	<result column="CUSTOMER_INFO_NAME"    	property="customerInfoName" 	     />
	<result column="DIV_INFO"    	property="divInfo" 	     />
</resultMap>

<resultMap class="Finance" id="FinanceForSAPResult">
	<result column="ROWNUM" 			property="rowNum" />
	<result column="SAP_ID" 			property="sapId" />
	<result column="NAME" 				property="name" />
	<result column="REGNO" 				property="regno" />
	<result column="DIRECTOR" 			property="director" />
</resultMap>

<resultMap class="Finance" id="FinanceForSapExtends">
	<result column="SAP_ID" 			property="sapId" />
	<result column="NAME" 				property="name" />
	<result column="REGNO" 				property="regno" />
	<result column="CORPORATION_NO" 	property="corporationNo" />
	<result column="DIRECTOR" 			property="director" />
	<result column="TYPE" 				property="type" />
	<result column="JIJONG_TYPE" 		property="jijongType" />
	<result column="POST_NO" 			property="postNo" />
	<result column="ADDRESS1" 			property="address1" />
	<result column="ADDRESS2" 			property="address2" />
	<result column="TEL_NO" 			property="telNo" />
	<result column="FAX" 				property="fax" />
	<result column="E_MAIL" 			property="eMail" />
</resultMap>
<resultMap class="FinanceCondition" id="ResultFinanceCondition">
	<result column="ID" 					property="id" />
	<result column="YEAR_DATE" 				property="yearDate" />
	<result column="YEAR_CONTENT" 			property="yearContent" />
</resultMap>

<resultMap class="MainPerson" id="ResultMainPerson">
	<result column="ID" 					property="id" />
	<result column="NAME" 					property="name" />
	<result column="JIKWE" 					property="jikwe" />
	<result column="TEL" 					property="tel" />
	<result column="E_MAIL" 				property="eMail" />
	<result column="OFFICER_FLAG" 			property="officerFlag" />
	<result column="KEYMAN_FLAG" 			property="keymanFlag" />
</resultMap>

<resultMap class="PersonStatic" id="ResultPersonStatic">
	<result column="ID" 					property="id" />
	<result column="MAN_EMPLOYEE1" 			property="manEmployee1" />
	<result column="MAN_EMPLOYEE2" 			property="manEmployee2" />
	<result column="MAN_EMPLOYEE3" 			property="manEmployee3" />
	<result column="MAN_EMPLOYEE4" 			property="manEmployee4" />
	<result column="WOMAN_EMPLOYEE1" 		property="womanEmployee1" />
	<result column="WOMAN_EMPLOYEE2" 		property="womanEmployee2" />
	<result column="WOMAN_EMPLOYEE3" 		property="womanEmployee3" />
	<result column="WOMAN_EMPLOYEE4" 		property="womanEmployee4" />	
	<result column="SUM_EMPLOYEE1" 		    property="totalEmployee1" />	
	<result column="SUM_EMPLOYEE2" 		    property="totalEmployee2" />	
	<result column="SUM_EMPLOYEE3" 		    property="totalEmployee3" />	
	<result column="SUM_EMPLOYEE4" 		    property="totalEmployee4" />	
</resultMap>

<resultMap class="MainBusiness" id="ResultMainBusiness">
	<result column="ID" 					property="id" />
	<result column="MAIN_CUSTOMER" 			property="mainCustomer" />
	<result column="MONTH_AVG" 			    property="monthAvg" />
	<result column="CHARGE_EMPLOYEE" 	  	property="chargeEmployee" />
	<result column="MAIN_PRODUCT" 			property="mainProduct" />
	<result column="SELLING_BUYING_RATE" 	property="sellingBuyingRate" />
	<result column="CONDITION" 				property="Condition" />
	<result column="SELLING_BUYING_FLAG" 	property="sellingBuyingFlag" />
</resultMap>


<resultMap class="RelationCompany" id="ResultRelationCompany">
	<result column="ID" 					property="id" />
	<result column="RELATION_NAME" 			property="relationName" />
	<result column="TYPE" 			    	property="type" />
	<result column="NOTE" 	  				property="note" />
</resultMap>


<resultMap class="Finance" id="FinanceResultExtends">
	<result column="ID" 						property="id" />
	<result column="SAP_ID" 					property="sapId" />
	<result column="NAME" 						property="name" />
	<result column="CEO_NAME"					property="ceoName"/>
	<result column="REGNO"						property="regno"/>
	<result column="POST_NO"					property="postNo"/>
	<result column="DIRECTOR"					property="director"/>
	<result column="CORPORATION_NO"				property="corporationNo"/>
	<result column="ADDRESS1"					property="address1"/>
	<result column="ADDRESS2"					property="address2"/>
	<result column="TEL_NO"						property="telNo"/>
	<result column="E_MAIL"						property="eMail"/>
	<result column="FAX"						property="fax"/>
	<result column="BUSINESS_EMPLOYEE" 			property="businessEmployee" />
	<result column="CHARGE"						property="charge"/>
	<result column="CUSTOMER_GUBUN"				property="customerGubun"/>
	<result column="SANGJANG_FLAG"				property="sangjangFlag"/>
	<result column="ESTABLISH_DATE"				property="establishDate"/>
	<result column="MAIN_BANK"					property="mainBank"/>
	<result column="SATTLING_MONTH"				property="sattlingMonth"/>
	<result column="EMPLOYEE_COUNT"				property="employeeCount"/>
	<result column="SUBDIVISION_GRADE"			property="subdivisionGrade"/>
	<result column="SELLING_AMT"				property="sellingAmt"/>
	<result column="BUSINESS_AMT"				property="businessAmt"/>
	<result column="STOCKHOLDER"				property="stockholder"/>
	<result column="COMPANY_PERCENT"			property="companyPercent"/>
	<result column="TYPE"	  					property="type"/>
	<result column="JIJONG_TYPE"				property="jijongType"/>
	<result column="MONTH_BUYING"				property="monthBuying"/>
	<result column="EQUIPMENT_STORE_NAME"		property="equipmentStoreName"/>
	<result column="EQUIPMENT_STORE_EXPLAN"		property="equipmentStoreExplan"/>
	<result column="EQUIPMENT_PRINT_NAME"		property="equipmentPrintName"/>
	<result column="EQUIPMENT_PRINT_EXPLAN"		property="equipmentPrintExplan"/>
	<result column="EQUIPMENT_ETC_NAME"			property="equipmentEtcName"/>
	<result column="EQUIPMENT_ETC_EXPLAN"		property="equipmentEtcExplan"/>
	<result column="HEAD_OFFICE_ADDRESS"		property="headOfficeAddress"/>
	<result column="FACTORY_ADDRESS1"			property="factoryAddress1"/>
	<result column="FACTORY_ADDRESS2"			property="factoryAddress2"/>
	<result column="DELETE_FLAG"				property="deleteFlag"/>
	<result column="REGISTER_ID" 	    		property="registerId"   	 />
	<result column="REGISTER_NAME"  			property="registerName" 	 />	
    <result column="REGIST_DATE"    			property="registDate" 	     />		
</resultMap>

<resultMap class="BuyingInfo" id="buyingInfoResult">
	<result column="SAP_ID" 				property="sapId" />
	<result column="SELLING_GROUP" 			property="sellingGroup" />
	<result column="CHANNEL" 			    property="channel" />
	<result column="PRODUCT_LINE" 	  		property="productLine" />
	<result column="BUSINESS_EMPLOYEE" 	 	property="businessEmployee" />
</resultMap>

<sql id="sqlColumnList">					
	    ID,
	    SAP_ID, 						
		NAME, 						
		CEO_NAME,					
		REGNO,						
		POST_NO,					
		DIRECTOR,					
		CORPORATION_NO,				
		ADDRESS1,					
		ADDRESS2,					
		TEL_NO,						
		E_MAIL,						
		FAX,										
		BUSINESS_EMPLOYEE, 			
		CHARGE,						
		CUSTOMER_GUBUN,							
		SANGJANG_FLAG,				
		ESTABLISH_DATE,				
		MAIN_BANK,					
		SATTLING_MONTH,				
		EMPLOYEE_COUNT,				
		SUBDIVISION_GRADE,			
		SELLING_AMT,				
		BUSINESS_AMT,				
		STOCKHOLDER,				
		COMPANY_PERCENT,			
		TYPE,	  					
		JIJONG_TYPE,				
		MONTH_BUYING,				
		EQUIPMENT_STORE_NAME,		
		EQUIPMENT_STORE_EXPLAN,		
		EQUIPMENT_PRINT_NAME,		
		EQUIPMENT_PRINT_EXPLAN,		
		EQUIPMENT_ETC_NAME,			
		EQUIPMENT_ETC_EXPLAN,		
		HEAD_OFFICE_ADDRESS,		
		FACTORY_ADDRESS1,			
		FACTORY_ADDRESS2,			
		DELETE_FLAG,				
		REGISTER_ID, 	    		
		REGISTER_NAME,  			
		REGIST_DATE   
</sql>

<select id="countBySearchCondition" parameterClass="FinanceSearchCondition" resultClass="int">
	SELECT COUNT(*) from (
		 SELECT CUSTOMER_INFO_ID FROM FINANCE_MASTER
	   WHERE DELETE_FLAG = 'N'
	   <isNotEmpty property="searchColumn">
			<isNotEmpty property="searchWord">
				<isEqual property="searchColumn" compareValue="name">
					AND 
					CUSTOMER_INFO_NAME LIKE '%' + #searchWord# + '%'
				</isEqual>
				<isEqual property="searchColumn" compareValue="registerName">
					and 
					REGISTER_NAME LIKE '%' + #searchWord# + '%'
				</isEqual>
				<isEqual property="searchColumn" compareValue="registDate">
					and 
					CONVERT(VARCHAR, REGIST_DATE, 102) = #searchWord#
				</isEqual>
			</isNotEmpty>
	 </isNotEmpty>  
	 GROUP BY CUSTOMER_INFO_ID
	  ) D 


</select>

<select id="countFinance" parameterClass="Finance" resultClass="int">
	SELECT COUNT(*) FROM FINANCE_MASTER
	WHERE CUSTOMER_INFO_ID = #customerInfoId#
	<isNotEmpty property="divInfo">
	AND DIV_INFO = #divInfo#
	</isNotEmpty>
	<isEmpty property="divInfo">
	AND YEAR_INFO = #yearInfo#
	</isEmpty>
</select>

<select id="countFinanceCondition" parameterClass="FinanceCondition" resultClass="int">
	SELECT COUNT(*) FROM FINANCE_CONDITION
	WHERE CUSTOMER_INFO_ID = #customerInfoId#
	<isNotEmpty property="divInfo">
	AND DIV_INFO = #divInfo#
	</isNotEmpty>
	<isEmpty property="divInfo">
	AND YEAR_INFO = #yearInfo#
	</isEmpty>
</select>

<select id="countFinanceRate" parameterClass="Finance" resultClass="int">
	SELECT COUNT(*) FROM FINANCE_RATE
	WHERE CUSTOMER_INFO_ID = #customerInfoId#
	<isNotEmpty property="divInfo">
	AND DIV_INFO = #divInfo#
	</isNotEmpty>
	<isEmpty property="divInfo">
	AND YEAR_INFO = #yearInfo#
	</isEmpty>
</select>



<select id="financeListBySearchCondition" parameterClass="FinanceSearchCondition" resultMap="FinanceResult">
		   
	 SELECT /* [MainSelling_SqlMap.xml] mainSellingListBySearchCondition */
 *
  FROM (SELECT AA.*
          FROM ( /* START========================================= */
    SELECT	ROW_NUMBER() OVER( ORDER BY
    							 <isNotEmpty property="sortColumn">
		 						   	<isEqual property="sortColumn" compareValue="NAME">
										<isEqual property="sortType" compareValue="DESC">
											B.CUSTOMER_INFO_NAME DESC
										</isEqual>
										<isEqual property="sortType" compareValue="ASC">
											B.CUSTOMER_INFO_NAME ASC
										</isEqual>
									</isEqual>
									<isEqual property="sortColumn" compareValue="REGISTER_NAME">
										<isEqual property="sortType" compareValue="DESC">
											B.REGISTER_NAME DESC
										</isEqual>
										<isEqual property="sortType" compareValue="ASC">
											B.REGISTER_NAME ASC
										</isEqual>
									</isEqual>
									<isEqual property="sortColumn" compareValue="REGIST_DATE">
										<isEqual property="sortType" compareValue="DESC">
											(SELECT MIN(C.REGIST_DATE) FROM FINANCE_MASTER C WHERE C.CUSTOMER_INFO_ID = B.CUSTOMER_INFO_ID) DESC
										</isEqual>
										<isEqual property="sortType" compareValue="ASC">
											(SELECT MIN(C.REGIST_DATE) FROM FINANCE_MASTER C WHERE C.CUSTOMER_INFO_ID = B.CUSTOMER_INFO_ID) ASC
										</isEqual>
									</isEqual>
		 						   </isNotEmpty>
		 						 <isEmpty property="sortColumn">  
		 							 B.CUSTOMER_INFO_NAME ASC
		 						 </isEmpty> 
		 						 ) AS ROWNUM ,
              B.CUSTOMER_INFO_ID AS ID,
			  B.CUSTOMER_INFO_NAME AS NAME,
	   B.REGISTER_ID,
	   B.REGISTER_NAME,
	   B.HIT_COUNT,
	   (SELECT MIN(C.REGIST_DATE) FROM FINANCE_MASTER C WHERE C.CUSTOMER_INFO_ID = B.CUSTOMER_INFO_ID) REGIST_DATE
	   FROM (SELECT CUSTOMER_INFO_ID,CUSTOMER_INFO_NAME,REGISTER_ID,REGISTER_NAME,HIT_COUNT FROM FINANCE_MASTER
		GROUP BY CUSTOMER_INFO_ID,CUSTOMER_INFO_NAME,REGISTER_ID,REGISTER_NAME,HIT_COUNT) B 
	   <isNotEmpty property="searchColumn">
			<isNotEmpty property="searchWord">
				<isEqual property="searchColumn" compareValue="name">
					where 
					B.CUSTOMER_INFO_NAME LIKE '%' + #searchWord# + '%'
				</isEqual>
				<isEqual property="searchColumn" compareValue="registerName">
					where 
					B.REGISTER_NAME LIKE '%' + #searchWord# + '%'
				</isEqual>
			</isNotEmpty>
	 </isNotEmpty>  
	   /* ===========================================END */
       	<![CDATA[   
                ) AA
         WHERE ROWNUM <= #endRowIndex# /* 종료  */
        ) TBL
		 WHERE ROWNUM > #startRowIndex# /* 시작 */ 
   ]]> 
	<isNotEmpty property="searchColumn">
		<isNotEmpty property="searchWord">
			<isEqual property="searchColumn" compareValue="registDate">
				and 
				CONVERT(VARCHAR, TBL.REGIST_DATE, 102) = #searchWord#
			</isEqual>	
		</isNotEmpty>
	</isNotEmpty>  

</select>

<select id="getFinance" parameterClass="String" resultMap="FinanceResultExtends">
	SELECT 
	 <include refid="support.customer.dao.finance.sqlColumnList"/>
	FROM BASICINFO_MASTER  WITH (NOLOCK)
	WHERE DELETE_FLAG = 'N'
	AND ID = #id#
</select>


<select id="getHistory" parameterClass="String" resultMap="ResultFinanceCondition" >

	SELECT 
	 ID
	FROM FINANCE_CONDITION  WITH (NOLOCK)
	WHERE ID = #id#

</select>
<select id="profitLossList" parameterClass="String" resultMap="profitLossResult" >
	SELECT 
		ID,
		YEAR_INFO,
		MNT1,   		
		MNT2,
		MNT3,
		MNT4,
		MNT5,
		MNT6,
		MNT7,
		MNT8,
		MNT9,
		MNT10,
		MNT11,
		MNT12,
		MNT13,
		MNT14,
		MNT15,
		MNT16,
		MNT17,
		CUSTOMER_INFO_ID,
		CUSTOMER_INFO_NAME,
		DIV_INFO
	FROM FINANCE_MASTER  WITH (NOLOCK)
	WHERE CUSTOMER_INFO_ID = #id#
	order by id
</select>

<select id="conditionList" parameterClass="String" resultMap="conditionResult" >
	SELECT 
		ID,
		YEAR_INFO,
		MNT1,   		
		MNT2,
		MNT3,
		MNT4,
		MNT5,
		MNT6,
		MNT7,
		MNT8,
		MNT9,
		MNT10,
		MNT11,
		MNT12,
		MNT13,
		MNT14,
		MNT15,
		MNT16,
		MNT17,
		MNT18,
		MNT19,
		MNT20,
		MNT21,
		MNT22,
		MNT23,
		MNT24,
		MNT25,
		MNT26,
		MNT27,
		MNT28,
		MNT29,
		CUSTOMER_INFO_ID,
		CUSTOMER_INFO_NAME,
		DIV_INFO
	FROM FINANCE_CONDITION  WITH (NOLOCK)
	WHERE CUSTOMER_INFO_ID = #id#
	order by div_info, year_info
</select>

<select id="rateList" parameterClass="String" resultMap="rateResult" >
	SELECT 
		ID,
		YEAR_INFO,
		MNT1,   		
		MNT2,
		MNT3,
		MNT4,
		MNT5,
		MNT6,
		MNT7,
		MNT8,
		MNT9,
		MNT10,
		MNT11,
		MNT12,
		CUSTOMER_INFO_ID,
		CUSTOMER_INFO_NAME,
		DIV_INFO
	FROM FINANCE_RATE  WITH (NOLOCK)
	WHERE CUSTOMER_INFO_ID = #id#
</select>

<select id="getMainPerson" parameterClass="String" resultMap="ResultMainPerson" >

	SELECT 
			 ID,
			 NAME,
			 JIKWE,
			 TEL,
			 E_MAIL,
			 OFFICER_FLAG,
			 KEYMAN_FLAG
	FROM     BASICINFO_MAIN_PERSON  WITH (NOLOCK)
	WHERE    ID = #id#

</select>

<select id="getPersonStatic" parameterClass="String" resultMap="ResultPersonStatic" >

	SELECT   ID,
			 MAN_EMPLOYEE1,
			 MAN_EMPLOYEE2,
			 MAN_EMPLOYEE3,
			 MAN_EMPLOYEE4,
			 WOMAN_EMPLOYEE1,
			 WOMAN_EMPLOYEE2,
			 WOMAN_EMPLOYEE3,
			 WOMAN_EMPLOYEE4,
			 SUM_EMPLOYEE1,
			 SUM_EMPLOYEE2,
			 SUM_EMPLOYEE3,
			 SUM_EMPLOYEE4
	FROM     BASICINFO_PERSON_STATIC  WITH (NOLOCK)
	WHERE    ID = #id#

</select>

<select id="getMainBusiness" parameterClass="String" resultMap="ResultMainBusiness" >

	SELECT 	ID 				
			,MAIN_CUSTOMER 	
			,MONTH_AVG 		
			,CHARGE_EMPLOYEE 
			,MAIN_PRODUCT 	
			,SELLING_BUYING_RATE 
			,CONDITION 			
			,SELLING_BUYING_FLAG 	
	FROM     BASICINFO_MAIN_BUSINESS  WITH (NOLOCK)
	WHERE    ID = #id#

</select>


<select id="getRelationCompany" parameterClass="String" resultMap="ResultRelationCompany" >

	SELECT 	    ID, 					
				RELATION_NAME, 			
				TYPE, 			    	
				NOTE 	  	
	FROM     BASICINFO_RELATION_COMPANY  WITH (NOLOCK)
	WHERE    ID = #id#
	ORDER BY RELATION_NAME
</select>

<update id="saveFinance" parameterClass="Finance">
	UPDATE FINANCE_MASTER
	SET 
		MNT1=#mnt1# 
		,MNT2=#mnt2#
		,MNT3=#mnt3#
		,MNT4=#mnt4#
		,MNT5=#mnt5#
		,MNT6=#mnt6#
		,MNT7=#mnt7#
		,MNT8=#mnt8#
		,MNT9=#mnt9#
		,MNT10=#mnt10#
		,MNT11=#mnt11#
		,MNT12=#mnt12#
		,MNT13=#mnt13#
		,MNT14=#mnt14#
		,MNT15=#mnt15#
		,MNT16=#mnt16#
		,MNT17=#mnt17#
		,UPDATER_NAME = #updaterName#
		,UPDATER_ID = #updaterId#
		,UPDATE_DATE = CURRENT_TIMESTAMP
		,DELETE_FLAG= 'N'						  
	WHERE CUSTOMER_INFO_ID = #customerInfoId#
	<isNotEmpty property="divInfo">
	AND DIV_INFO = #divInfo#
	</isNotEmpty>
	<isEmpty property="divInfo">
	AND YEAR_INFO = #yearInfo#
	</isEmpty>
</update>



<update id="updateFinanceRate" parameterClass="Finance">
	UPDATE FINANCE_RATE
	SET 
		MNT1=#mnt1# 
		,MNT2=#mnt2#
		,MNT3=#mnt3#
		,MNT4=#mnt4#
		,MNT5=#mnt5#
		,MNT6=#mnt6#
		,MNT7=#mnt7#
		,MNT8=#mnt8#
		,MNT9=#mnt9#
		,MNT10=#mnt10#
		,MNT11=#mnt11#
		,MNT12=#mnt12#
		,UPDATER_NAME = #updaterName#
		,UPDATER_ID = #updaterId#
		,UPDATE_DATE = CURRENT_TIMESTAMP
		,DELETE_FLAG= 'N'						  
	WHERE CUSTOMER_INFO_ID = #customerInfoId#
	<isNotEmpty property="divInfo">
	AND DIV_INFO = #divInfo#
	</isNotEmpty>
	<isEmpty property="divInfo">
	AND YEAR_INFO = #yearInfo#
	</isEmpty>
</update>

<update id="updateFinanceCondition" parameterClass="FinanceCondition">
	UPDATE FINANCE_CONDITION
	SET 
		MNT1=#mnt1# 
		,MNT2=#mnt2#
		,MNT3=#mnt3#
		,MNT4=#mnt4#
		,MNT5=#mnt5#
		,MNT6=#mnt6#
		,MNT7=#mnt7#
		,MNT8=#mnt8#
		,MNT9=#mnt9#
		,MNT10=#mnt10#
		,MNT11=#mnt11#
		,MNT12=#mnt12#
		,MNT13=#mnt13#
		,MNT14=#mnt14#
		,MNT15=#mnt15#
		,MNT16=#mnt16#
		,MNT17=#mnt17#
		,MNT18=#mnt18#
		,MNT19=#mnt19#
		,MNT20=#mnt20#
		,MNT21=#mnt21#
		,MNT22=#mnt22#
		,MNT23=#mnt23#
		,MNT24=#mnt24#
		,MNT25=#mnt25#
		,MNT26=#mnt26#
		,MNT27=#mnt27#
		,MNT28=#mnt28#
		,MNT29=#mnt29#
		,UPDATER_NAME = #updaterName#
		,UPDATER_ID = #updaterId#
		,UPDATE_DATE = CURRENT_TIMESTAMP
		,DELETE_FLAG= 'N'						  
	WHERE CUSTOMER_INFO_ID = #customerInfoId#
	<isNotEmpty property="divInfo">
	AND DIV_INFO = #divInfo#
	</isNotEmpty>
	<isEmpty property="divInfo">
	AND YEAR_INFO = #yearInfo#
	</isEmpty>
</update>

<delete id="deleteFinanceCondition" parameterClass ="String">
	DELETE FROM 
	FINANCE_CONDITION
	WHERE CUSTOMER_INFO_ID = #id#
</delete>

<delete id="deleteFinanceRate" parameterClass ="String">
	DELETE FROM 
	FINANCE_RATE
	WHERE CUSTOMER_INFO_ID = #id#
</delete>

<insert id="saveFinanceCondition" parameterClass="FinanceCondition">
		INSERT INTO FINANCE_CONDITION(
		ID,
		YEAR_INFO,
		MNT1,   		
		MNT2,
		MNT3,
		MNT4,
		MNT5,
		MNT6,
		MNT7,
		MNT8,
		MNT9,
		MNT10,
		MNT11,
		MNT12,
		MNT13,
		MNT14,
		MNT15,
		MNT16,
		MNT17,
		MNT18, 
		MNT19, 
		MNT20, 
		MNT21, 
		MNT22, 
		MNT23, 
		MNT24, 
		MNT25, 
		MNT26, 
		MNT27, 
		MNT28,
		MNT29,
		UPDATER_ID,
		UPDATER_NAME,
		UPDATE_DATE,				
		REGISTER_ID, 	    		
		REGISTER_NAME,  			
		REGIST_DATE, 
		CUSTOMER_INFO_ID,
		CUSTOMER_INFO_NAME,
		DIV_INFO
		)VALUES(
		#id#,
		#yearInfo#,
		#mnt1#, 
		#mnt2#,
		#mnt3#,
		#mnt4#,
		#mnt5#,
		#mnt6#,
		#mnt7#,
		#mnt8#,
		#mnt9#,
		#mnt10#,
		#mnt11#,
		#mnt12#,
		#mnt13#,
		#mnt14#,
		#mnt15#,
		#mnt16#,
		#mnt17#,
		#mnt18#,
		#mnt19#,
		#mnt20#,
		#mnt21#,
		#mnt22#,
		#mnt23#,
		#mnt24#,
		#mnt25#,
		#mnt26#,
		#mnt27#,
		#mnt28#,
		#mnt29#,
		#updaterId#,
		#updaterName#,
		CURRENT_TIMESTAMP ,
		#registerId#   	 ,
		#registerName# 	 ,	
		CURRENT_TIMESTAMP,
		#customerInfoId#,
		#customerInfoName#,
		#divInfo#
		)
</insert>

<insert  id="saveFinanceRate" parameterClass="Finance">

	INSERT INTO FINANCE_RATE(
		ID,
		YEAR_INFO,
		MNT1,   		
		MNT2,
		MNT3,
		MNT4,
		MNT5,
		MNT6,
		MNT7,
		MNT8,
		MNT9,
		MNT10,
		MNT11,
		MNT12,
		UPDATER_ID,
		UPDATER_NAME,
		UPDATE_DATE,				
		REGISTER_ID, 	    		
		REGISTER_NAME,  			
		REGIST_DATE,
		CUSTOMER_INFO_ID,
		CUSTOMER_INFO_NAME,
		DIV_INFO
		)VALUES(
		#id#,
		#yearInfo#,
		#mnt1#, 
		#mnt2#,
		#mnt3#,
		#mnt4#,
		#mnt5#,
		#mnt6#,
		#mnt7#,
		#mnt8#,
		#mnt9#,
		#mnt10#,
		#mnt11#,
		#mnt12#,
		#updaterId#,
		#updaterName#,
		CURRENT_TIMESTAMP ,
		#registerId#   	 ,
		#registerName# 	 ,	
		CURRENT_TIMESTAMP,
		#customerInfoId#,
		#customerInfoName#,
		#divInfo#
		)

</insert>

<delete id="deleteMainPerson1" parameterClass="String">
	DELETE FROM 
	BASICINFO_MAIN_PERSON
	WHERE ID= #id#
	AND OFFICER_FLAG = 'Y'
</delete>

<insert id="saveMainPerson1" parameterClass="MainPerson">
	INSERT INTO BASICINFO_MAIN_PERSON(
	ID,
	NAME,
	JIKWE,
	TEL,
	E_MAIL,
	OFFICER_FLAG
	)VALUES(
	#id#,
	#name#,
	#jikwe#,
	#tel#,
	#eMail#,
	'Y'
	)
</insert>

<delete id="deleteMainPerson2" parameterClass="String">
	DELETE FROM 
	BASICINFO_MAIN_PERSON
	WHERE ID= #id#
	AND OFFICER_FLAG = 'N'
</delete>

<insert id="saveMainPerson2" parameterClass="MainPerson">
	INSERT INTO BASICINFO_MAIN_PERSON(
	ID,
	NAME,
	JIKWE,
	E_MAIL,
	OFFICER_FLAG,
	KEYMAN_FLAG
	)VALUES(
	#id#,
	#name#,
	#jikwe#,
	#eMail#,
	'N',
	#keymanFlag#
	)
</insert>
<select id="psersonStaticCnt" parameterClass="String" resultClass="int">

	select COUNT(*) from BASICINFO_PERSON_STATIC
	WHERE ID = #id#
</select>

<update id="savePersonStatic" parameterClass="PersonStatic">
	UPDATE BASICINFO_PERSON_STATIC
	SET MAN_EMPLOYEE1 = #manEmployee1#,
		MAN_EMPLOYEE2 = #manEmployee2#,
		MAN_EMPLOYEE3 = #manEmployee3#,
		MAN_EMPLOYEE4 = #manEmployee4#,
		WOMAN_EMPLOYEE1 = #womanEmployee1#,
		WOMAN_EMPLOYEE2 = #womanEmployee2#,
		WOMAN_EMPLOYEE3 = #womanEmployee3#,
		WOMAN_EMPLOYEE4 = #womanEmployee4#,
		SUM_EMPLOYEE1 = #totalEmployee1#, 
		SUM_EMPLOYEE2 = #totalEmployee2#, 
		SUM_EMPLOYEE3 = #totalEmployee3#, 
		SUM_EMPLOYEE4 = #totalEmployee4#
	WHERE ID = #id#
</update>


<delete id="deleteRelationCompany" parameterClass="String">
	DELETE FROM 
	BASICINFO_RELATION_COMPANY
	WHERE ID= #id#
</delete>

<insert id="saveRelationCompany" parameterClass="RelationCompany">
	INSERT INTO BASICINFO_RELATION_COMPANY(
	ID,
	RELATION_NAME,
	TYPE,
	NOTE
	)VALUES(
	#id#,
	#relationName#,
	#type#,
	#note#
	)
</insert>

<insert id="createPersonStatic" parameterClass="PersonStatic">
	INSERT INTO BASICINFO_PERSON_STATIC(
		MAN_EMPLOYEE1, 
		MAN_EMPLOYEE2,
		MAN_EMPLOYEE3, 
		MAN_EMPLOYEE4, 
		WOMAN_EMPLOYEE1,
		WOMAN_EMPLOYEE2,
		WOMAN_EMPLOYEE3,
		WOMAN_EMPLOYEE4,
		SUM_EMPLOYEE1, 
		SUM_EMPLOYEE2, 
		SUM_EMPLOYEE3, 
		SUM_EMPLOYEE4,
		ID
	)VALUES(
		 #manEmployee1#,
		 #manEmployee2#,
		 #manEmployee3#,
		 #manEmployee4#,
		 #womanEmployee1#,
		 #womanEmployee2#,
		 #womanEmployee3#,
		 #womanEmployee4#,
		 #totalEmployee1#, 
		 #totalEmployee2#, 
		 #totalEmployee3#, 
		 #totalEmployee4#,
		 #id#
	)

</insert>

<delete id="deleteMainBusiness" parameterClass="String">
	DELETE FROM 
	BASICINFO_MAIN_BUSINESS
	WHERE ID= #id#
</delete>

<insert id="saveMainBusinessBuying" parameterClass="MainBusiness">

	INSERT INTO BASICINFO_MAIN_BUSINESS(
		ID,
		MAIN_CUSTOMER,
		MONTH_AVG,
		CHARGE_EMPLOYEE,
		MAIN_PRODUCT,
		SELLING_BUYING_RATE,
		CONDITION,
		SELLING_BUYING_FLAG
	)
	VALUES(
		#id#,
		#mainCustomer_b#,
		#monthAvg_b#,
		#chargeEmployee_b#,
		#mainProduct_b#,
		#sellingBuyingRate_b#,
		#condition_b#,
		'1'
	)
</insert>

<insert id="saveMainBusinessSelling" parameterClass="MainBusiness">

	INSERT INTO BASICINFO_MAIN_BUSINESS(
		ID,
		MAIN_CUSTOMER,
		MONTH_AVG,
		CHARGE_EMPLOYEE,
		MAIN_PRODUCT,
		SELLING_BUYING_RATE,
		CONDITION,
		SELLING_BUYING_FLAG
	)
	VALUES(
		#id#,
		#mainCustomer_s#,
		#monthAvg_s#,
		#chargeEmployee_s#,
		#mainProduct_s#,
		#sellingBuyingRate_s#,
		#condition_s#,
		'2'
	)
</insert>

<insert id="createFinance" parameterClass="Finance">
	INSERT INTO FINANCE_MASTER(
		    ID,
			DELETE_FLAG,
			UPDATER_ID,
			UPDATER_NAME,
			UPDATE_DATE,				
			REGISTER_ID, 	    		
			REGISTER_NAME,  			
			REGIST_DATE,
			YEAR_INFO,
			MNT1,   		
			MNT2,
			MNT3,
			MNT4,
			MNT5,
			MNT6,
			MNT7,
			MNT8,
			MNT9,
			MNT10,
			MNT11,
			MNT12,
			MNT13,
			MNT14,
			MNT15,
			MNT16,
			MNT17,
			CUSTOMER_INFO_ID,
			CUSTOMER_INFO_NAME,
			DIV_INFO
	)
	VALUES(
		#id#,
		'N',
		#updaterId#,
		#updaterName#,
		CURRENT_TIMESTAMP ,
		#registerId#   	 ,
		#registerName# 	 ,	
		CURRENT_TIMESTAMP,
		#yearInfo#,
		#mnt1#, 
		#mnt2#,
		#mnt3#,
		#mnt4#,
		#mnt5#,
		#mnt6#,
		#mnt7#,
		#mnt8#,
		#mnt9#,
		#mnt10#,
		#mnt11#,
		#mnt12#,
		#mnt13#,
		#mnt14#,
		#mnt15#,
		#mnt16#,
		#mnt17#,
		#customerInfoId#,
		#customerInfoName#,
		#divInfo#
	)



</insert>

<update id="deleteFinance" parameterClass="String">
	DELETE FROM 
	FINANCE_MASTER
	WHERE CUSTOMER_INFO_ID = #id#
</update>

<select id = "getBuyingInfo" parameterClass="String" resultMap="buyingInfoResult">

	SELECT SAP_ID,
		   SELLING_GROUP,
		   CHANNEL,
		   PRODUCT_LINE,
		   BUSINESS_EMPLOYEE
	FROM tmp_BASICINFO_BUYING  WITH (NOLOCK)
	WHERE SAP_ID = #sapId# 

</select>

<delete id="deleteSapCustomer">

	DELETE FROM tmp_BASICINFO_MASTER

</delete>

<delete id="deleteSapCustomerBuyingInfo">
	
	DELETE FROM tmp_BASICINFO_BUYING
	
</delete>

<insert id="updateSapCustomer" parameterClass="CustomerBasicInfo">

	INSERT INTO tmp_BASICINFO_MASTER
	(
		SAP_ID,
		NAME,
		REGNO,
		CORPORATION_NO,
		DIRECTOR,
		TYPE,
		JIJONG_TYPE,
		POST_NO,
		ADDRESS1,
		ADDRESS2,
		TEL_NO,
		FAX,
		E_MAIL
		
	)VALUES(
		#sapId#,
		#name#,
		#regno#,
		#corporationNo#,
		#director#,
		#type#,
		#jijongType#,
		#postNo#,
		#address1#,
		#address2#,
		#telNo#,
		#fax#,
		#eMail#	
	)
</insert>

<insert id="updateSapCustomerBuyingInfo" parameterClass="CustomerBuyingInfo">

	INSERT INTO tmp_BASICINFO_BUYING
	(	
		SAP_ID,
		SELLING_GROUP,
		CHANNEL,
		PRODUCT_LINE,
		CUSTOMER_GROUP2,
		CUSTOMER_GROUP3,
		BUSINESS_EMPLOYEE	
	)VALUES(
	
		#sapId#,
		#sellingGroup#,
		#channel#,
		#productLine#,
		#customerGroup2#,
		#customerGroup3#,
		#businessEmployee#	
	)
</insert>


<select id="countBySearchConditionForSAP" parameterClass="FinanceSearchCondition" resultClass="int">
	SELECT COUNT(*) from (
		 SELECT	ROW_NUMBER() OVER(ORDER BY NAME  ) AS ROWNUM ,
		SAP_ID,
		NAME,
		REGNO,
		DIRECTOR
	   FROM tmp_BASICINFO_MASTER WITH (NOLOCK)
	   WHERE 1=1
	   <isNotEmpty property="searchColumn">
			<isNotEmpty property="searchWord">
				<isEqual property="searchColumn" compareValue="name">
					AND 
					NAME LIKE '%' + #searchWord# + '%'
				</isEqual>
				<isEqual property="searchColumn" compareValue="regno">
					AND 
					REGNO LIKE '%' + #searchWord# + '%'
				</isEqual>
				<isEqual property="searchColumn" compareValue="sapId">
					AND 
					SAP_ID LIKE '%' + #searchWord# + '%'
				</isEqual>
			</isNotEmpty>
	 </isNotEmpty>  
	  ) D 

</select>

<select id="listSAPFinancebySearchCondition" parameterClass="FinanceSearchCondition" resultMap="FinanceForSAPResult">
	SELECT /* [MainSelling_SqlMap.xml] listSAPFinancebySearchCondition */
 *
  FROM (SELECT AA.*
          FROM ( /* START========================================= */
   SELECT	ROW_NUMBER() OVER(ORDER BY NAME  ) AS ROWNUM ,
		SAP_ID,
		NAME,
		REGNO,
		DIRECTOR
	   FROM tmp_BASICINFO_MASTER  WITH (NOLOCK)  
	   WHERE 1=1
	   <isNotEmpty property="searchColumn">
			<isNotEmpty property="searchWord">
				<isEqual property="searchColumn" compareValue="name">
					AND 
					NAME LIKE '%' + #searchWord# + '%'
				</isEqual>
				<isEqual property="searchColumn" compareValue="regno">
					AND 
					REGNO LIKE '%' + #searchWord# + '%'
				</isEqual>
				<isEqual property="searchColumn" compareValue="sapId">
					AND 
					SAP_ID LIKE '%' + #searchWord# + '%'
				</isEqual>
			</isNotEmpty>
	 </isNotEmpty>  
	   /* ===========================================END */
       	<![CDATA[   
                ) AA
         WHERE ROWNUM <= #endRowIndex# /* 종료  */
        ) TBL
		 WHERE ROWNUM > #startRowIndex# /* 시작 */ 
		 ORDER BY NAME
   ]]> ;	


</select>

<select id="readFinanceForSap" parameterClass="String" resultMap="FinanceForSapExtends">
	SELECT 		
			SAP_ID, 			
			NAME, 				
			REGNO, 				
			CORPORATION_NO, 	
			DIRECTOR, 			
			TYPE, 				
			JIJONG_TYPE, 		
			POST_NO, 			
			ADDRESS1, 			
			ADDRESS2, 			
			TEL_NO, 			
			FAX, 				
			E_MAIL
	FROM tmp_BASICINFO_MASTER  WITH (NOLOCK)
	WHERE SAP_ID = #sapId#
</select>

<update id="financeSAPSync" parameterClass="String">
	UPDATE BASICINFO_MASTER
	SET SAP_ID = B.SAP_ID, 			
		NAME = B.NAME, 				
		REGNO = B.REGNO, 				
		CORPORATION_NO = B.CORPORATION_NO, 	
		DIRECTOR = B.DIRECTOR, 			
		TYPE = B.TYPE, 				
		JIJONG_TYPE = B.JIJONG_TYPE, 		
		POST_NO = B.POST_NO, 			
		ADDRESS1 = B.ADDRESS1, 			
		ADDRESS2 = B.ADDRESS2, 			
		TEL_NO = B.TEL_NO, 			
		FAX = B.FAX, 				
		E_MAIL = B.E_MAIL 	
	FROM BASICINFO_MASTER A  WITH (NOLOCK) JOIN tmp_BASICINFO_MASTER B  WITH (NOLOCK) ON A.SAP_ID = B.SAP_ID
	WHERE A.SAP_ID = #sapId#
</update>

<update id="manInfoSAPSync" parameterClass="String">
	UPDATE PERSON_INFO
	SET SAP_ID = B.SAP_ID, 			
		NAME = B.NAME
	FROM PERSON_INFO A JOIN tmp_BASICINFO_MASTER B ON A.SAP_ID = B.SAP_ID
	WHERE A.SAP_ID = #sapId#
</update>

<update id="mainSellingSAPSync" parameterClass="String">
	UPDATE MAIN_SELLING
	SET SAP_ID = B.SAP_ID, 			
		NAME = B.NAME
	FROM MAIN_SELLING A JOIN tmp_BASICINFO_MASTER B ON A.SAP_ID = B.SAP_ID
	WHERE A.SAP_ID = #sapId#
</update>

<update id="counselHistorySAPSync" parameterClass="String">
	UPDATE COUNSEL_HISTORY
	SET SAP_ID = B.SAP_ID, 			
		NAME = B.NAME
	FROM COUNSEL_HISTORY A JOIN tmp_BASICINFO_MASTER B ON A.SAP_ID = B.SAP_ID
	WHERE A.SAP_ID = #sapId#
</update>

<select id="selectYearInfo" parameterClass ="String" resultClass="String">
	SELECT name FROM 
	FINANCE_CODE
	WHERE CODE = #code#
</select>

<update id="updateYearInfo1" parameterClass="Finance">
	UPDATE FINANCE_CODE
	SET 
		name=#startYear# 
		,UPDATER_NAME = #updaterName#
		,UPDATER_ID = #updaterId#
		,UPDATE_DATE = CURRENT_TIMESTAMP
	WHERE CODE = '001'
</update>
<update id="updateYearInfo2" parameterClass="Finance">
	UPDATE FINANCE_CODE
	SET 
		name=#endYear# 
		,UPDATER_NAME = #updaterName#
		,UPDATER_ID = #updaterId#
		,UPDATE_DATE = CURRENT_TIMESTAMP
	WHERE CODE = '002'
</update>



</sqlMap>